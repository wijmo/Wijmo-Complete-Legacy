/*
 *
 * Wijmo Library 2.1.4
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the Wijmo Commercial or GNU GPL Version 3 licenses.
 * licensing@wijmo.com
 * http://wijmo.com/license
 *
 *
 **/
(function(a){"use strict";a.widget("wijmo.wijgrid",{options:{allowColMoving:false,allowColSizing:false,allowEditing:false,allowKeyboardNavigation:false,allowPaging:false,allowSorting:false,alwaysParseData:true,cellStyleFormatter:undefined,columns:[],columnsAutogenerationMode:"merge",culture:"",customFilterOperators:[],data:null,ensureColumnsPxWidth:false,filterOperatorsSortMode:"alphabeticalCustomFirst",groupAreaCaption:"Drag a column here to group by that column.",groupIndent:10,highlightCurrentCell:false,loadingText:"Loading...",nullString:undefined,pageIndex:0,pageSize:10,pagerSettings:{mode:"numeric",pageButtonCount:10,position:"bottom"},readAttributesFromData:false,rowStyleFormatter:undefined,scrollMode:"none",selectionMode:"singleRow",showFilter:false,showFooter:false,showGroupArea:false,showRowHeader:false,staticColumnIndex:-1,staticRowIndex:-1,afterCellEdit:null,afterCellUpdate:null,beforeCellEdit:null,beforeCellUpdate:null,columnDragging:null,columnDragged:null,columnDropping:null,columnDropped:null,columnGrouping:null,columnGrouped:null,columnResizing:null,columnResized:null,columnUngrouping:null,columnUngrouped:null,currentCellChanging:null,currentCellChanged:null,filterOperatorsListShowing:null,filtering:null,filtered:null,groupAggregate:null,groupText:null,invalidCellValue:null,pageIndexChanging:null,pageIndexChanged:null,selectionChanged:null,sorting:null,sorted:null,ajaxError:null,dataLoading:null,dataLoaded:null,loading:null,loaded:null,rendering:null,rendered:null},_data$prefix:"wijgrid",_customSortOrder:1e3,_reverseKey:false,_pageSizeKey:10,_mergeWidgetsWithOptions:true,_ajaxError:function(b,a,c){this._trigger("ajaxError",null,{XMLHttpRequest:b,textStatus:a,errorThrown:c});this._deactivateSpinner()},_dataLoading:function(){this._trigger("dataLoading")},_dataLoaded:function(a){this._trigger("dataLoaded");this.doRefresh(a);this._loaded()},_loading:function(){this._activateSpinner();this._trigger("loading")},_loaded:function(){this._deactivateSpinner();this._trigger("loaded")},ensureControl:function(c,b){this._loading();if(!a.isPlainObject(b))b={data:null,afterRefresh:null,beforeRefresh:null};if(this._initialized){if(this._mergeWidgetsWithOptions){this._ownerise(false);this._widgetsToOptions()}}else this._prepareColumnOptions(false);this._ownerise(true);if(c===true)this._dataStore.load(b);else{this.doRefresh(b);this._loaded()}},doRefresh:function(g){if(!this._initialized)try{this._prepareColumnOptions(true)}catch(n){throw n;}finally{this._ownerise(true);this._initialized=true}else g&&a.isFunction(g.beforeRefresh)&&g.beforeRefresh.apply(this);this._rebuildLeaves();var f=this._dataStore.getDataSlice(),m=f.data,k,c,h,d,b,e,j,i,l;a.each(this._field("leaves"),function(){this._totalsValue=f.totals?f.totals[this.dataKey]:undefined});this._setPageCount(f);k=this._field("leaves");this.sketchTable=[];if(h=m.length)for(c=0;c<h;c++){d=m[c];b=[];for(e=0,j=k.length;e<j;e++){i=k[e];if(a.wijmo.wijgrid.validDataKey(i.dataKey)){b.push({value:d.values[i.dataKey],__attr:d.attributes?d.attributes.cellsAttributes[i.dataKey]:{},__style:{}});b.originalRowIndex=d.originalRowIndex}}b.rowType=a.wijmo.wijgrid.rowType.data;if(c%2!==0)b.rowType|=a.wijmo.wijgrid.rowType.dataAlt;b.__style={};b.__attr=d.attributes?d.attributes.rowAttributes:{};this.sketchTable.push(b)}else if(f.emptyData&&(h=f.emptyData.length))for(c=0;c<h;c++){d=f.emptyData[c];b=[];l=this._field("visibleLeaves").length;for(e=0,j=d.length;e<j;e++)b.push({html:d[e],__attr:{colSpan:l>0&&c===h-1?l-c:1},__style:{}});b.rowType=a.wijmo.wijgrid.rowType.emptyDataRow;b.__style={};b.__attr={};this.sketchTable.push(b)}this._onRendering();this._refresh();this._onRendered();g&&a.isFunction(g.afterRefresh)&&g.afterRefresh.apply(this)},getFilterOperatorsByDataType:function(b){var a=this.filterOperatorsCache.getByDataType(b||"string");this.filterOperatorsCache.sort(a,this.options.filterOperatorsSortMode);return a},setSize:function(d,c){var b=this._view(),e={type:"",hScrollValue:null,vScrollValue:null},g=this.outerDiv,f=this._field("frozener"),h=this._field("visibleLeaves");if(b&&b.getScrollValue)e=b.getScrollValue();if(d||d===0){this._autoWidth=false;g.width(d)}if(c||c===0){this._autoHeight=false;g.height(c)}a.each(h,function(c){var e=b.getHeaderCell(c),d=b.getJoinedCols(c);a(e).css("width","");a.each(d,function(c,b){a(b).css("width","")})});this._updateSplits(e);f&&f.refresh()},_prepareColumnOptions:function(g){a.wijmo.wijgrid.traverse(this.options.columns,function(b){b.isBand=a.isArray(b.columns)||b.clientType==="c1band";b._originalDataKey=b.dataKey;b._originalHeaderText=b.headerText});(new a.wijmo.wijgrid.bandProcessor)._getVisibleHeight(this.options.columns,true);var f=[],c,e=this._originalHeaderRowData(),d=this._originalFooterRowData(),b=(this.options.columnsAutogenerationMode||"").toLowerCase();if(g){c=this._dataStore.dataMode()===a.wijmo.wijgrid.dataMode.dom;b!=="none"&&new a.wijmo.wijgrid.columnsGenerator(this).generate(b,this._dataStore,this.options.columns)}a.wijmo.wijgrid.setTraverseIndex(this.options.columns);a.wijmo.wijgrid.traverse(this.options.columns,function(b){b.isBand=a.isArray(b.columns)||b.clientType==="c1band";a.wijmo.wijgrid.shallowMerge(b,a.wijmo.c1basefield.prototype.options);if(!b.isBand){a.wijmo.wijgrid.shallowMerge(b,a.wijmo.c1field.prototype.options);if(!b.clientType)b.clientType="c1field"}else b.clientType="c1band";b.isLeaf&&!b.isBand&&f.push(b)});this._field("leaves",f);g&&a.each(f,function(h,f){var g=typeof f.dataKey==="number"?f.dataKey:h;if(b==="merge"||f.dynamic===true)if(f.headerText===undefined)if(c&&e&&g<e.length)f.headerText=a.trim(e[g]);else if(a.wijmo.wijgrid.validDataKey(f.dataKey))f.headerText=""+f.dataKey;if(c&&d&&g<d.length)f._footerTextDOM=a.trim(d[g])})},_rebuildLeaves:function(){var b=[],d=[],c;if(this.options.showRowHeader){c=a.wijmo.wijgrid.createDynamicField({clientType:"c1basefield",dataIndex:-1,travIdx:-1,parentVis:true,allowMoving:false,allowSizing:false,allowSort:false,isRowHeader:true});c.owner=this;b.push(c)}a.each(this.options.columns,function(c,a){b.push(a)});this._field("columnHeadersTable",(new a.wijmo.wijgrid.bandProcessor).generateSpanTable(b,d));this._field("leaves",d);this._onLeavesCreated()},_onLeavesCreated:function(){var d=this._field("leaves"),c=0,b=0,e=this;this._field("visibleLeaves",a.grep(d,function(d,f){d.leavesIdx=f;if(a.wijmo.wijgrid.validDataKey(d.dataKey))d.dataIndex=c++;else d.dataIndex=-1;if(!d.isBand){e._ensureDataParser(d);if(a.isFunction(d.dataParser))d.dataParser=new d.dataParser}if(d.parentVis){d.visLeavesIdx=b++;return true}return false}))},_create:function(){if(!this.element.is("table"))throw"invalid markup";a.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(this.options);this.destroyed=false;var b=this.element[0].style.height,c=this.element[0].style.width;this._dataStore=new a.wijmo.wijgrid.dataStore(this);this._originalHtml=this.element.html();this.element.addClass("wijmo-wijgrid-root");this.element.wrap('<div class="ui-widget wijmo-wijgrid ui-widget-content ui-corner-all"></div>');this.outerDiv=this.element.parent();b&&this.outerDiv.css("height",this.element[0].style.height);if(b!==""&&b!=="auto")this._autoHeight=false;else this._autoHeight=true;c&&this.outerDiv.css("width",this.element[0].style.width);if(c!==""&&c!=="auto")this._autoWidth=false;else this._autoWidth=true;this.element.css({height:"",width:""});this.filterOperatorsCache=new a.wijmo.wijgrid.filterOperatorsCache;this._registerFilterOperator(a.wijmo.wijgrid.embeddedFilters);this.options.disabled&&this.disable();this.cellFormatter=new a.wijmo.wijgrid.cellFormatterHelper;this.rowStyleFormatter=new a.wijmo.wijgrid.rowStyleFormatterHelper(this);this.cellStyleFormatter=new a.wijmo.wijgrid.cellStyleFormatterHelper(this)},_init:function(){this.$superPanelHeader=null;this.$topPagerDiv=null;this.$bottomPagerDiv=null;this.$groupArea=null;this.filterOperatorsCache.removeCustom();a.each(this.options.customFilterOperators,function(b,a){if(a)a.custom=true});this._registerFilterOperator(this.options.customFilterOperators);this._field("closestCulture",Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"));if(!this.options.data){!this._field("thead")&&this._field("thead",a.wijmo.wijgrid.readTableSection(this.element,1));!this._field("tfoot")&&this._field("tfoot",a.wijmo.wijgrid.readTableSection(this.element,3))}this._initialized=this._initialized||false;this.ensureControl(true)},_setOption:function(c,b){var g=this["_preset_"+c],e=this.options[c],f,d;if(g!==undefined)b=g.apply(this,[b,e]);f=b!==e;a.Widget.prototype._setOption.apply(this,[c,b]);if(f){d=this["_postset_"+c];d!==undefined&&d.apply(this,[b,e])}},destroy:function(){var b,c=this;try{this._view().dispose();this._detachEvents(true);(b=this._field("resizer"))&&b.dispose();(b=this._field("frozener"))&&b.dispose();a.wijmo.wijgrid.iterateChildrenWidgets(this.outerDiv,function(b,a){a!==c&&a.destroy()});(b=this._field("selectionui"))&&b.dispose();(b=this._field("dragndrop"))&&b.dispose();a.wijmo.wijgrid.remove$dataByPrefix(this.element,this._data$prefix);this.element.removeClass("wijmo-wijgrid-root");this.element.html(this._originalHtml);this.element.insertBefore(this.outerDiv);this.outerDiv.remove();a.Widget.prototype.destroy.apply(this,arguments)}finally{this.destroyed=true}},columns:function(){return this._field("columns")||[]},currentCell:function(c,d){var b,f=this._view(),e=this._rows();if(arguments.length===0){b=this._field("currentCell");!b&&this._field("currentCell",b=a.wijmo.wijgrid.cellInfo.prototype.outsideValue);return b}else{b=arguments.length===1?c._clone():new a.wijmo.wijgrid.cellInfo(c,d);if(!b.isEqual(a.wijmo.wijgrid.cellInfo.prototype.outsideValue)){if(!b._isValid())throw"invalid arguments";b._clip(this._getDataCellsRange());if(b.rowIndex()>=0)if(!(f._getRowInfo(e.item(b.rowIndex())).type&a.wijmo.wijgrid.rowType.data))return}b._setGridView(this);this._changeCurrentCell(b);return this._field("currentCell")}},data:function(){return this._dataStore.dataSource().items},selection:function(){var b=this._field("selection");!b&&this._field("selection",b=new a.wijmo.wijgrid.selection(this));return b},beginEdit:function(){return this._beginEditInternal(null)},endEdit:function(){return this._endEditInternal(null)},pageCount:function(){return this.options.allowPaging?this._field("pageCount")||1:1},_dragndrop:function(){var b=this._field("dragndrop");!b&&this._field("dragndrop",b=new a.wijmo.wijgrid.dragAndDropHelper(this));return b},_headerRows:function(){return this._view().headerRows()},_filterRow:function(){return this._view().filterRow()},_localizeFilterOperators:function(b){var c=this;a.each(b,function(d,a){if(a.name){var b=c.filterOperatorsCache.getByName(a.name);if(b)b.displayName=a.displayName}})},_rows:function(){return this._view().bodyRows()},_selectionui:function(){var b=this._field("selectionui");!b&&this._field("selectionui",b=new a.wijmo.wijgrid.selectionui(this));return b},_setPageCount:function(a){this._field("pageCount",Math.ceil(a.totalRows/this.options.pageSize)||1)},_registerFilterOperator:function(b){var d=this,c=b&&(a.isArray(b)||a.isPlainObject(b)&&!b.operator)?b:arguments;a.each(c,function(b,a){d.filterOperatorsCache.add(a)})},_postset_allowColMoving:function(c){var b=this;a.each(this.columns(),function(d,a){if(c)b._dragndrop().attach(a);else b._dragndrop().detach(a)});a.each(this._field("groupedWidgets"),function(d,a){if(c)b._dragndrop().attach(a);else b._dragndrop().detach(a)})},_postset_allowSorting:function(){this.ensureControl(false)},_postset_columns:function(){throw"read-only";},_postset_allowPaging:function(){this.ensureControl(true)},_postset_culture:function(){throw"read-only";},_postset_customFilterOperators:function(b){this.filterOperatorsCache.removeCustom();a.each(this.options.customFilterOperators,function(b,a){a.custom=true});this._registerFilterOperator(b)},_postset_data:function(){this._ownerise(false);a.wijmo.wijgrid.traverse(this.options.columns,function(b,c){if(b.dynamic){var d=a.inArray(b,c);d>=0&&c.splice(d,1)}else{b.dataKey=b._originalDataKey;b.headerText=b._originalHeaderText}});this._initialized=false;this.options.pageIndex=0;this._dataStore=new a.wijmo.wijgrid.dataStore(this);this.ensureControl(true)},_postset_disabled:function(c){var d=this,b=this._view();a.wijmo.wijgrid.iterateChildrenWidgets(this.outerDiv,function(b,a){a!==d&&a.option("disabled",c)});b&&b.ensureDisabledState()},_postset_groupIndent:function(){this.ensureControl(false)},_postset_groupAreaCaption:function(b){var a=this._field("groupedColumns");this.$groupArea&&(!a||!a.length)&&this.$groupArea.html(b||"&nbsp;")},_postset_highlightCurrentCell:function(b){var a=this.currentCell();a&&a._isValid()&&this._highlightCellPosition(a,b)},_preset_pageIndex:function(a,c){if(isNaN(a))throw"out of range";var b=this.pageCount();if(a>b-1)a=b-1;if(a<0)a=0;if(this.options.allowPaging&&a!==c)if(!this._onPageIndexChanging({newPageIndex:a}))a=c;return a},_postset_pageIndex:function(){this.options.allowPaging&&this.ensureControl(true,{afterRefresh:function(){this._onPageIndexChanged()}})},_preset_pageSize:function(a){if(isNaN(a))throw"out of range";if(a<=0)a=1;return a},_postset_pageSize:function(){this.options.pageIndex=0;this.options.allowPaging&&this.ensureControl(true)},_postset_pagerSettings:function(){this.ensureControl(false)},_postset_scrollMode:function(b,a){if(b==="none"||a==="none")this.ensureControl(false);else this._view().refreshPanel()},_postset_selectionMode:function(d){var c=this.selection(),b=this.currentCell();c.beginUpdate();c.clear();b&&b._isValid()&&c._selectRange(new a.wijmo.wijgrid.cellInfoRange(b,b),false,false,0,null);c.endUpdate();this._view().toggleDOMSelection(d==="none")},_postset_showFilter:function(){this.ensureControl(false)},_postset_showGroupArea:function(){this.ensureControl(false)},_postset_showRowHeader:function(){this.ensureControl(false)},_postset_staticRowIndex:function(){this.options.scrollMode!=="none"&&this.ensureControl(false)},_postset_staticColumnIndex:function(){this.options.scrollMode!=="none"&&this.ensureControl(false)},_activateSpinner:function(){var a=this.outerDiv.append('<div class="wijmo-wijgrid-overlay ui-widget-overlay"></div><span class="wijmo-wijgrid-loadingtext ui-widget-content ui-corner-all"><span class="ui-icon ui-icon-clock"></span>'+this.options.loadingText+"</span>").find("> .wijmo-wijgrid-loadingtext");a.position({my:"center",at:"center center",of:this.outerDiv,collision:"none"})},_deactivateSpinner:function(){this.outerDiv.find("> .wijmo-wijgrid-overlay, > .wijmo-wijgrid-loadingtext").remove()},_columnWidgetsFactory:function(e,b){var c,d=b.clientType;if(!d&&b.isBand)d="c1band";b=a.extend({owner:this},b,{disabled:this.options.disabled});switch(d){case"c1basefield":c=e.c1basefield(b);break;case"c1band":c=e.c1band(b);break;default:c=e.c1field(b)}return c},_field:function(c,b){return a.wijmo.wijgrid.dataPrefix(this.element,this._data$prefix,c,b)},_removeField:function(b){var a=this._data$prefix+b;this.element.removeData(a)},_prepareFilterRequest:function(d){var b=this._field("leaves"),c;if(!b)return[];c=a.map(b,a.proxy(function(b){if(!b.isBand&&a.wijmo.wijgrid.validDataKey(b.dataKey)&&b.filterOperator){var f=a.extend(true,{},{foo:b.filterValue}).foo,e=a.extend(true,{},{foo:b.filterOperator}).foo,c=a.wijmo.wijgrid.filterHelper.verify(e,f,b.dataType,this.filterOperatorsCache);if(c)return d?[{column:b,filterOperator:c.filterOperator,filterValue:c.filterValue}]:[{dataKey:b.dataKey,filterOperator:c.filterOperator,filterValue:c.filterValue}]}return null},this));return c},_preparePageRequest:function(){return this.options.allowPaging?{pageIndex:this.options.pageIndex,pageSize:this.options.pageSize}:null},_prepareSortRequest:function(){var c=this._field("leaves"),b;if(!c||!this.options.allowSorting)return[];b=a.map(c,function(b){var c=null;if(!b.isBand&&b.allowSort&&a.wijmo.wijgrid.validDataKey(b.dataKey)){if(b.groupInfo&&b.groupInfo.position!=="none"&&b.sortDirection==="none")b.sortDirection="ascending";c=b.sortDirection==="ascending"||b.sortDirection==="descending"?[{dataKey:b.dataKey,sortDirection:b.sortDirection,sortOrder:b.sortOrder||0}]:null}return c});b.sort(function(a,b){return a.sortOrder-b.sortOrder});a.each(b,function(b,a){delete a.sortOrder});return b},_prepareTotalsRequest:function(d){var b=this._field("leaves"),c;if(!b||!this.options.showFooter)return[];c=a.map(b,function(b){return!b.isBand&&a.wijmo.wijgrid.validDataKey(b.dataKey)&&b.aggregate&&b.aggregate!=="none"?d?[{column:b,aggregate:b.aggregate}]:[{dataKey:b.dataKey,aggregate:b.aggregate}]:null});return c},_widgetsToOptions:function(){var b=a.wijmo.wijgrid.flatten(this.options.columns);a.each(this.columns(),function(e,c){delete c.options.columns;var d=b[c.options.travIdx];a.extend(true,d,c.options);d.filterValue=c.options.filterValue;d.filterOperator=c.options.filterOperator})},_recreateColumnWidgets:function(){a.each(this.columns(),function(b,a){a.destroy()});var h=[],f=this._headerRows(),b,d,i,c,g,j,e;if(f&&f.length()){b=[];a.wijmo.wijgrid.traverse(this.options.columns,function(a){a.parentVis&&b.push(a)});for(d=0,i=b.length;d<i;d++){c=b[d];g=f.item(c.thY);j=(new a.wijmo.wijgrid.rowAccessor).getCell(g,c.thX);e=this._columnWidgetsFactory(a(j),c);h.push(e.data(e.data(a.wijmo.c1basefield.prototype._data$prefix+"widgetName")))}}this._field("columns",h)},_ownerise:function(b){if(b){var c=this;a.wijmo.wijgrid.traverse(this.options.columns,function(d){d.owner=c;var a,b,e;if(a=d.groupInfo){a.owner=d;if(a.expandInfo)for(b=0,e=a.expandInfo.length;b<e;b++)a.expandInfo[b].owner=a}})}else a.wijmo.wijgrid.traverse(this.options.columns,function(c){delete c.owner;var a,b,d;if(a=c.groupInfo){delete a.owner;if(a.expandInfo)for(b=0,d=a.expandInfo.length;b<d;b++)delete a.expandInfo[b].owner}})},_updateSplits:function(a){this._view().updateSplits!==null&&this._view().updateSplits(a)},_refresh:function(){var b=this._view(),c,e,d,g={type:"",hScrollValue:null,vScrollValue:null},f=[];if(b&&b.getScrollValue)g=b.getScrollValue();this._detachEvents(false);this.element.detach();this.element.empty();this.outerDiv.empty();this.outerDiv.append(this.element);if(this._field("selectionui")){this._field("selectionui").dispose();this._field("selectionui",null)}this._field("resizer")&&this._field("resizer").dispose();this._field("frozener")&&this._field("frozener").dispose();(new a.wijmo.wijgrid.grouper).group(this,this.sketchTable,this._field("leaves"));(new a.wijmo.wijgrid.merger).merge(this.sketchTable,this._field("visibleLeaves"));if(this.options.scrollMode!=="none")this._field("view",b=new a.wijmo.wijgrid.fixedView(this));else this._field("view",b=new a.wijmo.wijgrid.flatView(this));this._render();this._ownerise(false);this._recreateColumnWidgets();this._ownerise(true);if(this.options.allowPaging){this.$topPagerDiv&&this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5);this.$bottomPagerDiv&&this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5)}this._attachEvents();b.focusableElement().attr("tabIndex",0);if(this.currentCell()._isValid()&&this.currentCell(this.currentCell()))this.currentCell()._isEdit(false);else this.currentCell(this._getFirstDataRowCell(0));this._field("selection",null);c=this.currentCell();if(c._isValid()){this.selection()._startNewTransaction(c);this.selection()._selectRange(new a.wijmo.wijgrid.cellInfoRange(c,c),false,false,0,null)}this._selectionui();e=new a.wijmo.wijgrid.resizer(this);a.each(this.columns(),function(c,b){var a=b.options;a.visible&&a.parentVis&&a.isLeaf&&e.addElement(b)});this._field("resizer",e);this._updateSplits(g);if(this.options.scrollMode!=="none"){d=new a.wijmo.wijgrid.frozener(this);d.addVElement(this._getStaticIndex(false));d.addHElement(this._getStaticIndex(true));d.attachDivEvent();this._field("frozener",d)}a.each(this.columns(),function(c,a){if(!a.options.isBand&&a.options.showFilter===true){var b=a._getFilterEditorWidth();b!==undefined&&f.push({widget:a,width:b})}});a.each(f,function(b,a){a.widget._setFilterEditorWidth(a.width)})},_needToCreatePagerItem:function(){return this.options.allowPaging},_render:function(){var d=this._view(),b=this.options,c;d.render();c=this.outerDiv;if(b.scrollMode!=="none")c=this.outerDiv.find("div.wijmo-wijgrid-scroller:first");this.$superPanelHeader=null;if(this.$topPagerDiv){this.$topPagerDiv.data("wijpager")&&this.$topPagerDiv.wijpager("destroy");this.$topPagerDiv.remove()}this.$topPagerDiv=null;if(this._needToCreatePagerItem()&&(b.pagerSettings.position==="top"||b.pagerSettings.position==="topAndBottom"))if(!this.$topPagerDiv){c.prepend(this.$superPanelHeader=a('<div class="wijmo-wijsuperpanel-header"></div>'));this.$superPanelHeader.prepend(this.$topPagerDiv=a('<div class="wijmo-wijgrid-header ui-widget-header ui-corner-top"></div>'))}if(b.showGroupArea)this._processGroupArea(c);else this.$groupArea=null;if(this.$bottomPagerDiv){this.$bottomPagerDiv.data("wijpager")&&this.$bottomPagerDiv.wijpager("destroy");this.$bottomPagerDiv.remove()}this.$bottomPagerDiv=null;if(this._needToCreatePagerItem()&&(b.pagerSettings.position==="bottom"||b.pagerSettings.position==="topAndBottom"))!this.$bottomPagerDiv&&c.append(this.$bottomPagerDiv=a('<div class="wijmo-wijgrid-footer wijmo-wijsuperpanel-footer ui-state-default ui-corner-bottom"></div>'))},_processGroupArea:function(e){var b=this,d=this._field("groupedColumns"),c=[];this.$groupArea=a('<div class="ui-widget-content ui-helper-clearfix"></div>');if(d.length>0)a.each(d,function(f,d){var e=a('<a href="#"></a>').appendTo(b.$groupArea);e.c1groupedfield(a.extend({owner:b},{allowMoving:d.allowMoving,allowSort:d.allowSort,dataIndex:d.dataIndex,headerText:d.headerText,isBand:d.isBand,isLeaf:d.isLeaf,linearIdx:d.linearIdx,parentIdx:d.parentIdx,sortDirection:d.sortDirection,travIdx:d.travIdx,groupedIndex:d.groupedIndex},{disabled:b.options.disabled}));c.push(e.data("c1groupedfield"))});else this.$groupArea.addClass("wijmo-wijgrid-group-area").html(this.options.groupAreaCaption||"&nbsp;");this._field("groupedWidgets",c);!this.$superPanelHeader&&e.prepend(this.$superPanelHeader=a('<div class="wijmo-wijsuperpanel-header"></div>'));this.$superPanelHeader.prepend(this.$groupArea);this._dragndrop().attachGroupArea(this.$groupArea)},_attachEvents:function(){var b=this._view(),c=b.focusableElement();c.bind("keydown."+this.widgetName,a.proxy(this._onKeyDown,this));c.bind("keypress."+this.widgetName,a.proxy(this._onKeyPress,this));a.each(b.subTables(),a.proxy(function(d,c){var b=c.element();if(b){b.tHead&&a(b.tHead).bind("click."+this.widgetName,a.proxy(this._onClick,this));b.tBodies.length&&a(b.tBodies[0]).bind("click."+this.widgetName,a.proxy(this._onClick,this)).bind("dblclick."+this.widgetName,a.proxy(this._onDblClick,this)).bind("mousemove."+this.widgetName,a.proxy(this._onMouseMove,this)).bind("mouseout."+this.widgetName,a.proxy(this._onMouseOut,this)).find("> tr.wijmo-wijgrid-groupheaderrow > td .wijmo-wijgrid-grouptogglebtn").bind("click."+this.widgetName,a.proxy(this._onGroupBtnClick,this))}},this))},_detachEvents:function(e){var b=this._view(),c=this,d;if(b){d=b.focusableElement();d.unbind("keydown."+this.widgetName);d.unbind("keypress."+this.widgetName);a.each(b.subTables(),function(){var b=this.element();if(b){b.tHead&&a(b.tHead).unbind("."+c.widgetName);b.tBodies.length&&a(b.tBodies[0]).unbind("."+c.widgetName)}});e&&a.each(b.getJoinedTables(true,0),function(d,b){b&&typeof b!=="number"&&a(b.element()).find("> tbody").find("> tr.wijmo-wijgrid-groupheaderrow > td .wijmo-wijgrid-grouptogglebtn").unbind("."+c.widgetName)})}},_handleSort:function(c,f){var g=this.options.columns,e=c.travIdx,d,b;if(c&&this.options.allowSorting){d=c.sortDirection==="none"?"ascending":c.sortDirection==="ascending"?"descending":"ascending";b={column:c,sortDirection:d};if(this._onColumnSorting(b)){b.column.sortDirection=b.sortDirection;if(f)b.column.sortOrder=this._customSortOrder++;else{this._customSortOrder=1e3;a.each(this.columns(),function(b,a){a.options.sortOrder=0;if(a.options.travIdx!==e&&!(a.options.groupInfo&&a.options.groupInfo.position!=="none"))a.options.sortDirection="none"});a.wijmo.wijgrid.traverse(g,function(a){a.sortOrder=0;if(a.travIdx!==e&&!(a.groupInfo&&a.groupInfo.position!=="none"))a.sortDirection="none"})}this.ensureControl(true,{afterRefresh:function(){this._onColumnSorted({column:b.column})}})}}},_pagerSettings2PagerWidgetSettings:function(){return a.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:a.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:a.proxy(this._onPagerWidgetPageIndexChanged,this)})},_handleDragnDrop:function(i,j,d,e,f){var c=a.wijmo.wijgrid.getColumnByTravIdx(this.options.columns,i),b=a.wijmo.wijgrid.getColumnByTravIdx(this.options.columns,j),g=e?"groupArea":"columns",h=f?"groupArea":"columns";if(f)this._onColumnGrouping({drag:c.found,drop:b?b.found:null,dragSource:g,dropSource:h,at:d})&&this.ensureControl(true,{beforeRefresh:function(){if(!b)c.found.groupedIndex=0;else switch(d){case"left":c.found.groupedIndex=b.found.groupedIndex-.5;break;case"right":c.found.groupedIndex=b.found.groupedIndex+.5}!e&&a.extend(true,c.found,{groupInfo:{position:"header"}})},afterRefresh:function(){this._onColumnGrouped({drag:c.found,drop:b?b.found:null,dragSource:g,dropSource:h,at:d})}});else this._onColumnDropping({drag:c.found,drop:b.found,at:d})&&this.ensureControl(false,{beforeRefresh:function(){c.at.splice(c.found.linearIdx,1);switch(d){case"left":if(c.at===b.at&&c.found.linearIdx<b.found.linearIdx)b.at.splice(b.found.linearIdx-1,0,c.found);else b.at.splice(b.found.linearIdx,0,c.found);break;case"right":if(c.at===b.at&&c.found.linearIdx<b.found.linearIdx)b.at.splice(b.found.linearIdx,0,c.found);else b.at.splice(b.found.linearIdx+1,0,c.found);break;case"center":b.found.columns.push(c.found)}a.wijmo.wijgrid.setTraverseIndex(this.options.columns)},afterRefresh:function(){this._onColumnDropped({drag:c.found,drop:b.found,at:d})}})},_handleFilter:function(a,f,g){var d=this.filterOperatorsCache.getByName(f),b,e,c;if(d){if(d.arity>1){b=this._parse(a.options,g);e=b!==null&&(a.options.dataType==="string"||!isNaN(b))}else e=true;if(e){c={column:a.options,operator:d.name,value:b};if(this._onColumnFiltering(c)){a.options.filterValue=c.value;a.options.filterOperator=c.operator;this.options.pageIndex=0;this.ensureControl(true,{afterRefresh:function(){this._onColumnFiltered({column:a.options})}})}}}},_handleUngroup:function(c){var b=a.wijmo.wijgrid.getColumnByTravIdx(this.options.columns,c);if(b&&b.found){b=b.found;this._onColumnUngrouping({column:b})&&this.ensureControl(false,{beforeRefresh:function(){delete b.groupedIndex;a.extend(true,b,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:b})}})}},_onColumnDropping:function(a){return this._trigger("columnDropping",null,a)},_onColumnDropped:function(a){this._trigger("columnDropped",null,a)},_onColumnGrouping:function(a){return this._trigger("columnGrouping",null,a)},_onColumnGrouped:function(a){this._trigger("columnGrouped",null,a)},_onColumnUngrouping:function(a){return this._trigger("columnUngrouping",null,a)},_onColumnUngrouped:function(a){this._trigger("columnUngrouped",null,a)},_onColumnFiltering:function(a){return this._trigger("filtering",null,a)},_onColumnFiltered:function(a){this._trigger("filtered",null,a)},_onColumnSorting:function(a){return this._trigger("sorting",null,a)},_onColumnSorted:function(a){this._trigger("sorted",null,a)},_onCurrentCellChanged:function(){var b=this.options,a;if(b.allowKeyboardNavigation){a=this._field("currentCell");b.scrollMode!=="none"&&a&&!a.isEqual(a.outsideValue)&&this._view().scrollTo(a)}this._trigger("currentCellChanged")},_onPageIndexChanging:function(a){return this._trigger("pageIndexChanging",null,a)},_onPageIndexChanged:function(){this._trigger("pageIndexChanged")},_onPagerWidgetPageIndexChanging:function(b,a){a.handled=true},_onPagerWidgetPageIndexChanged:function(b,a){this._setOption("pageIndex",a.newPageIndex)},_onRendering:function(){this._rendered=false;this._trigger("rendering")},_onRendered:function(){this._rendered=true;this._trigger("rendered")},_onClick:function(d){if(!this._canInteract()||!d.target)return;var j=this._view(),i=this._getParentSubTable(d.target,["td","th"],j.subTables()),h,g,b,f=0,e,c;if(i){h=i[0];g=a(h).closest("tr");if(!(g.is(".wijmo-wijgrid-datarow")||g.is(".wijmo-wijgrid-headerrow")))return;if(!g.length)return;b=j.getAbsoluteCellInfo(h)._absToData(this._getDataToAbsOffset());if(b.cellIndex()<0||b.rowIndex()<0)if(b.rowIndex()>=0){b=new a.wijmo.wijgrid.cellInfo(0,b.rowIndex());f=2}else{b=this._getFirstDataRowCell(b.cellIndex());f=1}this._changeCurrentCell(b);e=this.currentCell();c=this.selection();(!d.shiftKey||!c._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")&&c._startNewTransaction(e);c.beginUpdate();if(d.shiftKey&&d.ctrlKey)c._clearRange(new a.wijmo.wijgrid.cellInfoRange(e,e),f);else c._selectRange(new a.wijmo.wijgrid.cellInfoRange(c._anchorCell(),e),d.ctrlKey,d.shiftKey,f,null);c.endUpdate()}},_onDblClick:function(a){this._beginEditInternal(a)},_onGroupBtnClick:function(e){if(!this._canInteract())return;var g=a(e.target).closest("tr"),f=new a.wijmo.wijgrid.groupHelper,c=f.getGroupInfo(g[0]),d,b;if(c){d=f.getColumnByGroupLevel(this._field("leaves"),c.level);if(d){b=d.groupInfo.expandInfo[c.index];if(b.isExpanded)b.collapse(e.shiftKey);else b.expand(e.shiftKey);this._view().ensureHeight()}}},_onKeyDown:function(b){if(!this._canInteract())return true;var d=b.target.tagName.toLowerCase(),g=false,f,h,e,c;if((d==="input"||d==="option"||d==="select"||d==="textarea")&&a(b.target).closest("tr.wijmo-wijgrid-datarow").length===0)return true;if(this.options.allowEditing)if((b.which===a.ui.keyCode.ESCAPE||b.which===113)&&this.currentCell()._isValid()&&this.currentCell()._isEdit()){this._endEditInternal(b);return false}else if(b.which===113){this._beginEditInternal(b);return false}if(!this.options.allowKeyboardNavigation||b.which===a.ui.keyCode.TAB)return true;switch(b.which){case a.ui.keyCode.LEFT:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.TAB:f=this._getNextCurrencyPos(this._getDataCellsRange(),this.currentCell(),b.keyCode,b.shiftKey);g=this._canMoveToAnotherCell(b.target,b.which)}if(g){this._changeCurrentCell(new a.wijmo.wijgrid.cellInfo(f.cellIndex,f.rowIndex));e=this.currentCell();c=this.selection();(!b.shiftKey||!c._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")&&c._startNewTransaction(e);c.beginUpdate();c._selectRange(new a.wijmo.wijgrid.cellInfoRange(c._anchorCell(),e),false,b.shiftKey,0,null);c.endUpdate();return false}return true},_onKeyPress:function(c){if(this._canInteract()&&this.options.allowEditing){var g=c.which,f=this.currentCell(),b,d,e;if(g&&f._isValid()&&!f._isEdit()){b=c.target.tagName.toLowerCase();if(b!=="input"&&b!=="option"&&b!=="select"&&b!=="textarea"){d=a(c.target).closest(".wijmo-wijgrid-table");if(d.length){e=a.map(this._view().subTables(),function(a){return a.element()});if(a.inArray(d[0],e)>=0)if(a.wij.charValidator.isPrintableChar(String.fromCharCode(g))){this._beginEditInternal(c);return false}}}}}},_onMouseMove:function(k){if(!this._canInteract())return;var e=this._view(),i=this._getParentSubTable(k.target,["td","th"],e.subTables()),h,f,g,b,d,c,j=a.wijmo.wijgrid.renderState;if(i){h=i[0];f=a(h).closest("tr");if(!f.length||f.is(".wijmo-wijgrid-foorow")||!(f.is(".wijmo-wijgrid-datarow")||f.is(".wijmo-wijgrid-headerrow")))return;g=e.getAbsoluteCellInfo(h)._absToData(this._getDataToAbsOffset());b=this._field("hoveredRow");if(b!==undefined&&g.rowIndex()!==b){d=this._rows().item(b);if(d){c=e._getRowInfo(d);e._changeRowRenderState(c,j.hovered,false);this.rowStyleFormatter.format(c)}}b=g.rowIndex();this._field("hoveredRow",b);if(b>=0){d=this._rows().item(b);if(d){c=e._getRowInfo(d);e._changeRowRenderState(c,j.hovered,true);this.rowStyleFormatter.format(c)}}}},_onMouseOut:function(f){if(a(f.relatedTarget).closest(".wijmo-wijgrid-data").length===0){var d=this._field("hoveredRow"),c,b,e=this._view();if(d>=0){c=this._rows().item(d);if(c){b=e._getRowInfo(c);e._changeRowRenderState(b,a.wijmo.wijgrid.renderState.hovered,false);this.rowStyleFormatter.format(b)}}}},_fieldResized:function(b,c,a){if(c<0)c=0;if(a<=0)a=1;if(this._trigger("columnResizing",null,{column:b.options,oldWidth:c,newWidth:a})!==false){b.option("width",a);this._trigger("columnResized",null,{column:b.options})}},_changeCurrentCell:function(b){var a=this.currentCell(),c=this._getDataCellsRange(),f,e,d=this.options.highlightCurrentCell;if(c._isValid()&&c._containsCellInfo(b)||b.isEqual(b.outsideValue))if(a.cellIndex()!==b.cellIndex()||a.rowIndex()!==b.rowIndex()){f={cellIndex:b.cellIndex(),rowIndex:b.rowIndex(),oldCellIndex:a.cellIndex(),oldRowIndex:a.rowIndex()};if(this._trigger("currentCellChanging",null,f)){e=false;if(!this.options.allowEditing||!a._isEdit()||(e=this._endEditInternal(null))){d&&c._containsCellInfo(a)&&this._highlightCellPosition(a,false);a=b._clone();a._setGridView(this);d&&this._highlightCellPosition(a,true);this._field("currentCell",a);this._onCurrentCellChanged()}}}else d&&this._highlightCellPosition(a,true)},_highlightCellPosition:function(d,i){if(d&&d._isValid()){var j=d._clone()._dataToAbs(this._getDataToAbsOffset()),g=j.cellIndex(),k=j.rowIndex(),h=a.wijmo.wijgrid.renderState,c=this._view(),b,e,f;b=c.getHeaderCell(g);if(b){e=c._getRowInfo(this._headerRows().item(d.column().thY));b=a(b);f=c._changeCellRenderState(b,h.current,i);this.cellStyleFormatter.format(b,g,d.column(),e,f)}b=c.getJoinedRows(k,0);if(b){e=c._getRowInfo(b);c._changeRowRenderState(e,h.current,i);this.rowStyleFormatter.format(e)}b=c.getCell(g,k);if(b){b=a(b);f=c._changeCellRenderState(b,h.current,i);this.cellStyleFormatter.format(b,g,d.column(),e,f)}}},_beginEditInternal:function(d){if(this._canInteract()&&this.options.allowEditing){var c=this.currentCell().column(),b;if(c&&!c.readOnly){b=(new a.wijmo.wijgrid.cellEditorHelper).currentCellEditStart(this,d);b;return b}}return false},_endEditInternal:function(c){if(this._canInteract()&&this.options.allowEditing){var b=(new a.wijmo.wijgrid.cellEditorHelper).currentCellEditEnd(this,c);b&&this._view().ensureHeight(this.currentCell().rowIndex());return b}return false},_onViewInsertEmptyRow:function(){return null},_onViewCreateEmptyCell:function(){return null},_onViewCellRendered:function(){},_onViewRowRendered:function(){},_ensureDataParser:function(b){switch(b.dataType){case undefined:case"string":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.stringParser;break;case"boolean":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.boolParser;break;case"number":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.numberParser;break;case"currency":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.currencyParser;break;case"datetime":if(!b.dataParser)b.dataParser=a.wijmo.wijgrid.embeddedParsers.dateTimeParser;break;default:throw a.wijmo.wijgrid.stringFormat('Unsupported dataType value: "{0}"',b.dataType);}},_parseDOM:function(a,b){return a.dataParser.parseDOM(b,this._field("closestCulture"),a.dataFormatString,this.options.nullString,true)},_parse:function(b,c){var a=b.dataParser.parse(c,this._field("closestCulture"),b.dataFormatString,this.options.nullString,true);switch(b.dataType){case"datetime":if(a!==null&&!(a instanceof Date))throw"invalid value.";break;case"number":case"currency":if(a!==null&&(typeof a!=="number"||isNaN(a)))throw"invalid value.";break;case"boolean":if(a!==null&&(typeof a!=="boolean"||isNaN(a)))throw"invalid value.";break;case"string":if(a!==null&&typeof a!=="string")throw"invalid value.";}return a},_toStr:function(a,b){return a.dataParser.toStr(b,this._field("closestCulture"),a.dataFormatString,this.options.nullString,true)},_funcOptions:function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","ajaxError","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]},_canInteract:function(){return!this.options.disabled},_canMoveToAnotherCell:function(d,c){var h=d.tagName.toLowerCase(),f,e,b,g;switch(h){case"input":if(a(d).hasClass("wijgridinput")){if(d.type==="text"){f=d.value.length;e=new a.wijmo.wijgrid.domSelection(d).getSelection();b=a.ui.keyCode;g=c===b.UP||c===b.DOWN||c===b.PAGE_DOWN||c===b.PAGE_UP||e.length===0&&(e.start===0&&(c===b.LEFT||c===b.HOME)||e.end>=f&&(c===b.RIGHT||c===b.END));return g}return true}return false;case"textarea":case"select":return false}return true},_getDataToAbsOffset:function(){var c=0,a=0,b=this._headerRows();if(this.options.showRowHeader)c++;if(b)a+=b.length();if(this._filterRow())a++;return{x:c,y:a}},_getDataCellsRange:function(){var d=0,e=0,b=this._field("visibleLeaves").length-1,c=this._rendered?this._rows().length()-1:this.sketchTable.length-1;if(this.options.showRowHeader)b--;if(b<0||c<0)d=e=b=c=-1;return new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(d,e),new a.wijmo.wijgrid.cellInfo(b,c))},_getDataItem:function(a){return this.data()[a]},_getFirstDataRowCell:function(f){var b,e,c,g=this._view(),d=this._rows(),h=a.wijmo.wijgrid.rowType;for(b=0,e=d.length();b<e;b++){c=g._getRowInfo(d.item(b));if(c.type&h.data)return new a.wijmo.wijgrid.cellInfo(f,b)}return a.wijmo.wijgrid.cellInfo.prototype.outsideValue},_getNextCurrencyPos:function(b,f,h,g){var d=f.cellIndex(),c=f.rowIndex(),e;switch(h){case a.ui.keyCode.PAGE_UP:if(this._reverseKey&&c===b.topLeft().rowIndex())c=b.bottomRight().rowIndex();else{c-=this._pageSizeKey;if(c<(e=b.topLeft().rowIndex()))c=e}break;case a.ui.keyCode.PAGE_DOWN:if(this._reverseKey&&c===b.bottomRight().rowIndex())c=b.TopLeft().RowIndex();else{c+=this._pageSizeKey;if(c>(e=b.bottomRight().rowIndex()))c=e}break;case a.ui.keyCode.END:d=this._reverseKey&&d===b.bottomRight().cellIndex()?b.topLeft().cellIndex():b.bottomRight().cellIndex();break;case a.ui.keyCode.HOME:d=this._reverseKey&&d===b.topLeft().cellIndex()?b.bottomRight().cellIndex():b.topLeft().cellIndex();break;case a.ui.keyCode.LEFT:if(d>b.topLeft().cellIndex())d--;else if(this._reverseKey)d=b.bottomRight().cellIndex();break;case a.ui.keyCode.UP:if(c>b.topLeft().rowIndex())c--;else if(this._reverseKey)c=b.bottomRight().rowIndex();break;case a.ui.keyCode.RIGHT:if(d<b.bottomRight().cellIndex())d++;else if(this._reverseKey)d=b.topLeft().cellIndex();break;case a.ui.keyCode.ENTER:case a.ui.keyCode.DOWN:if(c<b.bottomRight().rowIndex())c++;else if(this._reverseKey)c=b.topLeft().rowIndex();break;case a.ui.keyCode.TAB:if(0)if(g){d--;if(d<b.topLeft().cellIndex()){d=b.bottomRight().cellIndex();c--;if(c<b.topLeft().rowIndex())c=b.bottomRight().rowIndex()}}else{d++;if(d>b.bottomRight().cellIndex()){d=b.topLeft().cellIndex();c++;if(c>b.bottomRight().rowIndex())c=b.topLeft().rowIndex()}}}return{cellIndex:d,rowIndex:c}},_getParentSubTable:function(b,g,h){for(var f=a.map(h,function(a){return a.element()}),c=null,d=null,e;b!==null&&c===null;b=b.parentNode){e=b.tagName?b.tagName.toLowerCase():undefined;if(a.inArray(e,g)>=0)d=b;else if(a.inArray(b,f)>=0)c=b}return d&&c?[d,c]:null},_getStaticIndex:function(c){var a,b=this._getDataCellsRange();if(this._hasSpannedCells())return-1;if(c)a=Math.min(this.options.staticRowIndex,b.bottomRight().rowIndex());else a=Math.min(this.options.staticColumnIndex,b.bottomRight().cellIndex());if(a<-1)a=-1;return a},_getRealStaticColumnIndex:function(g){var d,b,c=0,e=this._getStaticIndex(false),a,f;if(this.options.showRowHeader===true)c++;if(g)return c;a=e+c;if(e>=0){d=this._field("visibleLeaves");b=d.length;f=a;for(;a<b;a++)if(d[a].parentIdx===-1){if(a>f)a--;break}if(a>=b)a=b-1}return a},_getRealStaticRowIndex:function(b){var a=this._field("columnHeadersTable").length;if(this.options.showFilter)a++;return b?a:this._getStaticIndex(true)+a},_hasSpannedCells:function(){var d=this._field("leaves"),c,e,a,b=false;for(c=0,e=d.length;c<e&&!b;c++){a=d[c];b=a.groupInfo&&a.groupInfo.position!=="none";b|=a.parentVis&&a.rowMerge!=="none"}return b},_view:function(){return this._field("view")},_originalFooterRowData:function(){var a=this._field("tfoot");return a&&a.length?a[0]:null},_originalHeaderRowData:function(){var a=this._field("thead");return a&&a.length?a[0]:null}})})(jQuery);(function(a){"use strict";a.widget("wijmo.c1basefield",{_data$prefix:"c1basefield",options:{allowMoving:true,allowSizing:true,cellFormatter:undefined,dataKey:undefined,ensurePxWidth:undefined,footerText:undefined,headerText:undefined,visible:true,width:undefined},_create:function(){var a=this.options.owner;this.element.addClass("ui-widget wijmo-c1basefield ui-state-default");this._field("owner",a);delete this.options.owner;this._field("widgetName",this.widgetName);this.options.disabled&&this.disable();a.options.allowColMoving&&a._dragndrop().attach(this)},_init:function(){this.element.wrapInner("<div class='wijmo-wijgrid-innercell'></div>");this._refreshHeaderCell()},destroy:function(){var b=this._owner();b&&b._dragndrop().detach(this);a.wijmo.wijgrid.remove$dataByPrefix(this.element,this._data$prefix);this.element.removeClass("ui-widget wijmo-c1basefield ui-state-default").html(this.element.find(".wijmo-wijgrid-headertext").contents())},_field:function(c,b){return a.wijmo.wijgrid.dataPrefix(this.element,this._data$prefix,c,b)},_removeField:function(b){var a=this._data$prefix+b;this.element.removeData(a)},_setOption:function(c,b,f){var h=this["_preset_"+c],e=this.options[c],g,d;if(h!==undefined)b=h.apply(this,[b,e,f]);g=b!==e;a.Widget.prototype._setOption.apply(this,[c,b]);if(g){d=this["_postset_"+c];d!==undefined&&d.apply(this,[b,e,f])}},_postset_allowMoving:function(b,c,a){this._invokeGroupedColumn("allowMoving",b,a)},_preset_clientType:function(){throw"read-only";},_postset_headerText:function(b,c,a){this._refreshHeaderCell();this._invokeGroupedColumn("headerText",b,a)},_postset_visible:function(){this._owner().ensureControl(false)},_postset_width:function(e){var c=this._owner()._view(),b=this.options.visLeavesIdx,d=a(c.getHeaderCell(b)).outerWidth();c.ensureWidth(b,e,d)},_invokeGroupedColumn:function(d,c,a){if(!a&&this.options.groupedIndex!==undefined){var b=this._owner()._field("groupedWidgets")[this.options.groupedIndex];b._setOption(d,c,true)}},_owner:function(){return this._field("owner")},_canSize:function(){return this.options.allowSizing&&this._owner().options.allowColSizing},_canDrag:function(){return this.options.allowMoving===true},_canDropTo:function(b){return a.wijmo.wijgrid.isChildOf(this._owner().options.columns,b,this)?false:true},_refreshHeaderCell:function(){var a=this.element.children(".wijmo-wijgrid-innercell").empty().html(this.options.headerText||"").wrapInner('<span class="wijmo-wijgrid-headertext" />')}})})(jQuery);(function(a){"use strict";a.widget("wijmo.c1field",a.wijmo.c1basefield,{options:{aggregate:"none",allowSort:true,dataType:"string",dataParser:undefined,dataFormatString:undefined,filterOperator:"nofilter",filterValue:undefined,groupInfo:{expandInfo:[],groupSingleRow:true,collapsedImageClass:"ui-icon-triangle-1-e",expandedImageClass:"ui-icon-triangle-1-se",position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},readOnly:false,rowMerge:"none",showFilter:true,sortDirection:"none",valueRequired:false},_create:function(){a.wijmo.c1basefield.prototype._create.apply(this,arguments);this.element.addClass("ui-widget wijmo-c1field")},destroy:function(){this.element.find("*").unbind("."+this.widgetName);if(this.$filterEditor){this.$filterEditor.closest("td").find("*").unbind("."+this.widgetName);switch(this._getInputEditorType(this.options)){case"date":this.$filterEditor.data("wijinputdate")&&this.$filterEditor.wijinputdate("destroy");break;case"mask":this.$filterEditor.data("wijinputmask")&&this.$filterEditor.wijinputmask("destroy");break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.data("wijinputnumber")&&this.$filterEditor.wijinputnumber("destroy")}this.$filterEditor=null}this.element.removeClass("ui-widget wijmo-c1field").find(".wijmo-wijgrid-headertext > span.ui-icon").remove();this._removeDropDownFilterList();a.wijmo.c1basefield.prototype.destroy.apply(this,arguments)},_init:function(){a.wijmo.c1basefield.prototype._init.apply(this,arguments);this.$filterEditor=null;var b=this._owner();this.filterRow=b._filterRow();b.options.showFilter&&this.options.showFilter&&this.options.dataIndex>=0&&this._prepareFilterCell()},_postset_aggregate:function(){this._owner().ensureControl(false)},_postset_allowSort:function(b,c,a){this._refreshHeaderCell();this._invokeGroupedColumn("allowSort",b,a)},_postset_dataType:function(){throw"read-only";},_postset_dataParser:function(){this._owner().ensureControl(false)},_postset_dataFormatString:function(){this._owner().ensureControl(false)},_postset_filterOperator:function(){this._owner().ensureControl(true)},_postset_filterValue:function(){this._owner().ensureControl(true)},_postset_groupInfo:function(){this._owner().ensureControl(true)},_postset_rowMerge:function(){this._owner().ensureControl(false)},_postset_showFilter:function(){this._owner().ensureControl(false)},_postset_sortDirection:function(){this.options.sortOrder=0;this._owner().ensureControl(true)},_postset_width:function(){this._setFilterEditorWidth(1);a.wijmo.c1basefield.prototype._postset_width.apply(this,arguments);this._setFilterEditorWidth(this._getFilterEditorWidth())},_canDropTo:function(b){return a.wijmo.c1basefield.prototype._canDropTo.apply(this,arguments)?this.options.groupedIndex!==undefined&&b instanceof a.wijmo.c1groupedfield?false:true:false},_canSort:function(){var a=this._owner();return a&&a.options.allowSorting&&this.options.allowSort&&this.options.dataIndex>=0},_refreshHeaderCell:function(){if(this._canSort()){var b,c=this.element.children(".wijmo-wijgrid-innercell").empty().html(this.options.headerText||"").wrapInner('<a class="wijmo-wijgrid-headertext" href="#" role="button" />');b=c.children("a").bind("click."+this.widgetName,this,this._onHrefClick);switch(this.options.sortDirection){case"ascending":b.append(a('<span class="ui-icon ui-icon-triangle-1-n">ascending</span>'));break;case"descending":b.append(a('<span class="ui-icon ui-icon-triangle-1-s">descending</span>'))}}else a.wijmo.c1basefield.prototype._refreshHeaderCell.apply(this,arguments)},_prepareFilterCell:function(){var g=this.options.visLeavesIdx,e=null,d=null,b,c,f=this,h;if(g>=0){e=this._owner();if(this.filterRow)d=a((new a.wijmo.wijgrid.rowAccessor).getCell(this.filterRow,g));else throw"exception";this.$filterEditor=d.find("input");d.bind(a.support.selectstart?"selectstart":"mousedown",function(a){a.stopPropagation()});b=e._parse(this.options,a.wijmo.wijgrid.filterHelper.getSingleValue(this.options.filterValue));if(b===null)switch(this.options.dataType){case"boolean":b=false;break;case"number":case"currency":case"datetime":b=0;break;default:b=""}c={culture:e.options.culture,disabled:e.options.disabled,decimalPlaces:function(b){var a=/^(n|p|c){1}(\d*)$/.exec(b);if(a)if(a[2])return parseInt(a[2],10);return 2}(this.options.dataFormatString)};switch(h=this._getInputEditorType(this.options)){case"date":this.$filterEditor.wijinputdate(a.extend(c,{date:b,dateFormat:this.options.dataFormatString||undefined}));break;case"mask":this.$filterEditor.wijinputmask({text:b+""});break;case"numberCurrency":this.$filterEditor.wijinputnumber(a.extend(c,{type:"currency",value:b}));break;case"numberNumber":this.$filterEditor.wijinputnumber(a.extend(c,{value:b}));break;case"numberPercent":this.$filterEditor.wijinputnumber(a.extend(c,{type:"percent",value:b*100}));break;default:throw a.wijmo.wijgrid.stringFormat('Unsupported editor type: "{0}"',h);}d.find(".wijmo-wijgrid-filter-trigger").attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(){!f.options.disabled&&a(this).addClass("ui-state-hover")}).bind("mouseleave."+this.widgetName,function(){!f.options.disabled&&a(this).removeClass("ui-state-hover ui-state-active")}).bind("mouseup."+this.widgetName,this,function(){!f.options.disabled&&a(this).removeClass("ui-state-active")}).bind("mousedown."+this.widgetName,{column:this},this._onFilterBtnClick).bind("click."+this.widgetName,function(a){a.preventDefault()})}},_onFilterBtnClick:function(m){var b=m.data.column,j=8,c,k,g,d,f,i,e,h,l;if(b.options.disabled)return false;if(b.$dropDownFilterList){b._removeDropDownFilterList();return false}c=b._owner();k=a.wijmo.wijgrid.filterHelper.getSingleOperatorName(b.options.filterOperator).toLowerCase();g=c.filterOperatorsCache.getByDataType(b.options.dataType);c.filterOperatorsCache.sort(g,c.options.filterOperatorsSortMode);d=a.extend(true,{},{operators:g,column:b.options});c._trigger("filterOperatorsListShowing",null,d);f=[];if(d.operators)for(i in d.operators)if(d.operators.hasOwnProperty(i)){e=d.operators[i];f.push({label:e.displayName||e.name,value:e.name,selected:e.name.toLowerCase()===k})}b.$dropDownFilterList=a('<div class="wijmo-wijgrid-filterlist"></div').appendTo(document.body).wijlist({autoSize:true,maxItemsCount:j,selected:function(f,e){var a,d;switch(d=b._getInputEditorType(b.options)){case"date":a=b.$filterEditor.wijinputdate("option","date")||new Date;break;case"mask":a=b.$filterEditor.wijinputmask("option","text");break;case"numberCurrency":case"numberNumber":case"numberPercent":a=b.$filterEditor.wijinputnumber("option","value");if(d==="numberPercent")a/=100}b._removeDropDownFilterList();c._handleFilter(b,e.item.value,a)}});b.$dropDownFilterList.wijlist("setItems",f).wijlist("renderList");h=b.$dropDownFilterList.width()|150;b.$dropDownFilterList.width(f.length>j?h+20:h).wijlist("refreshSuperPanel").position({of:a(this),my:"left top",at:"left bottom"});b.$dropDownFilterList.$button=a(this);l=b.$dropDownFilterList.eventGuid=+new Date;a(document).bind("mousedown."+b.widgetName+"."+l,{column:b},b._onDocMouseDown)},_onDocMouseDown:function(c){var b=a(c.target),e=b.parents(".wijmo-wijgrid-filterlist:first"),d=b.is(".wijmo-wijgrid-filter-trigger")?b:b.parents(".wijmo-wijgrid-filter-trigger:first");!(d.length&&d[0]===c.data.column.$dropDownFilterList.$button[0]||e.length&&e[0]===c.data.column.$dropDownFilterList[0])&&c.data.column._removeDropDownFilterList()},_onHrefClick:function(a){if(a.data.options.disabled)return false;a.data.options.allowSort&&a.data._owner()._handleSort(a.data.options,a.ctrlKey);return false},_removeDropDownFilterList:function(){if(this.$dropDownFilterList){var b=this.$dropDownFilterList.eventGuid;this.$dropDownFilterList.remove();this.$dropDownFilterList=null;a(document).unbind("mousedown."+this.widgetName+"."+b,this._onDocMouseDown)}},_getFilterEditorWidth:function(){if(this.$filterEditor){var b=this.$filterEditor.closest(".wijmo-wijgrid-filter"),a=b.width()-b.find(".wijmo-wijgrid-filter-trigger").width();if(!a||a<0)a=0;return a}return undefined},_setFilterEditorWidth:function(a){if(this.$filterEditor){a-=this.$filterEditor.leftBorderWidth()+this.$filterEditor.rightBorderWidth();if(a<0)a=0;switch(this._getInputEditorType(this.options)){case"date":this.$filterEditor.wijinputdate("widget").width(a);break;case"mask":this.$filterEditor.wijinputmask("widget").width(a);break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.wijinputnumber("widget").width(a)}this.$filterEditor.setOutWidth(a)}},_getInputEditorType:function(a){switch(a.dataType){case"number":return a.dataFormatString&&a.dataFormatString.indexOf("p")===0?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"mask"}}})})(jQuery);(function(a){"use strict";a.widget("wijmo.c1groupedfield",{_data$prefix:"c1groupedfield",options:{allowMoving:true,allowSort:true,headerText:undefined,sortDirection:"none"},_create:function(){var a=this.options.owner;this.element.addClass("wijmo-wijgrid-group-button ui-state-default ui-corner-all");this._field("owner",a);delete this.options.owner;this.options.disabled&&this.disable();a.options.allowColMoving&&a._dragndrop().attach(this)},_init:function(){this._refreshHeaderCell()},destroy:function(){this.element.find("*").unbind("."+this.widgetName);var b=this._owner();b&&b._dragndrop().detach(this);a.wijmo.wijgrid.remove$dataByPrefix(this.element,this._data$prefix)},_field:function(c,b){return a.wijmo.wijgrid.dataPrefix(this.element,this._data$prefix,c,b)},_removeField:function(b){var a=this._data$prefix+b;this.element.removeData(a)},_setOption:function(c,b,f){var h=this["_preset_"+c],e=this.options[c],g,d;if(h!==undefined)b=h.apply(this,[b,e,f]);g=b!==e;a.Widget.prototype._setOption.apply(this,[c,b]);if(g){d=this["_postset_"+c];d!==undefined&&d.apply(this,[b,e,f])}},_postset_headerText:function(){this._refreshHeaderCell()},_postset_allowSort:function(){this._refreshHeaderCell()},_owner:function(){return this._field("owner")},_canSize:function(){return this.options.allowSizing&&this._owner().options.allowColSizing},_canDrag:function(){return this.options.allowMoving===true},_canDropTo:function(b){return!(b instanceof a.wijmo.c1groupedfield)?false:a.wijmo.wijgrid.isChildOf(this._owner().options.columns,b,this)?false:true},_canSort:function(){var a=this._owner();return a&&a.options.allowSorting&&this.options.allowSort&&this.options.dataIndex>=0},_refreshHeaderCell:function(){var b=a('<span class="wijmo-wijgrid-group-button-close ui-state-default ui-corner-all"><span class="ui-icon ui-icon-close"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);this.element.html(this.options.headerText||"").prepend(b).bind("click."+this.widgetName,this,this._onHrefClick);if(this._canSort())switch(this.options.sortDirection){case"ascending":this.element.append(a('<span class="wijmo-wijgrid-group-button-sort ui-icon ui-icon-triangle-1-n"></span>'));break;case"descending":this.element.append(a('<span class="wijmo-wijgrid-group-button-sort ui-icon ui-icon-triangle-1-s"></span>'))}},_onCloseClick:function(a){var b=a.data.options;!b.disabled&&a.data._owner()._handleUngroup(a.data.options.travIdx);return false},_onHrefClick:function(e){var d=e.data._owner(),c=e.data.options,b;if(!c.disabled&&c.allowSort){b=a.wijmo.wijgrid.search(d.columns(),function(a){return a.options.travIdx===c.travIdx});b=!b.found?a.wijmo.wijgrid.getColumnByTravIdx(d.options.columns,c.travIdx).found:b.found.options;b&&d._handleSort(b,e.ctrlKey)}return false}})})(jQuery);(function(a){"use strict";a.widget("wijmo.c1band",a.wijmo.c1basefield,{options:{columns:[]},_create:function(){a.wijmo.c1basefield.prototype._create.apply(this,arguments);this.element.addClass("ui-widget wijmo-c1band")},_canDropTo:function(b){return a.wijmo.c1basefield.prototype._canDropTo.apply(this,arguments)?!(b instanceof a.wijmo.c1groupedfield):false}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{bandProcessor:function(){var c,h,b,g,e,f,d;this.generateSpanTable=function(j,i){c=h=f=e=0;b=[];g=[];d=[];var a=this._generateSpanTable(j,i,true);return a};this._generateSpanTable=function(i,e,j){var d,f;c=this._getVisibleHeight(i,j);e=e||[];a.wijmo.wijgrid.traverse(i,function(a){a.isLeaf&&e.push(a);g.push(a)});h=e.length;for(d=0;d<c;d++){b[d]=[];for(f=0;f<h;f++)b[d][f]={column:null,colSpan:0,rowSpan:0}}this._setTableValues(i,0,0);return b};this._getVisibleHeight=function(b,g){var d,e,h,f,c=0;if(a.isArray(b))for(d=0,e=b.length;d<e;d++){f=this._getVisibleHeight(b[d],g);c=Math.max(c,f)}else{h=b.visible===undefined?true:b.visible;b.parentVis=h&&g;if(b.isBand){for(d=0,e=b.columns.length;d<e;d++){f=this._getVisibleHeight(b.columns[d],b.parentVis);c=Math.max(c,f)}if(!b.parentVis)return c;b.isLeaf=c===0;c++}else{b.isLeaf=true;if(b.parentVis)c=1}}return c};this._getVisibleParent=function(a){while(a){a=g[a.parentIdx];if(a&&(a.parentVis||a.parentVis===undefined))return a}return null};this._setTableValues=function(g,h,n){var i,l,m,j,o,k;if(a.isArray(g))for(i=0,l=g.length;i<l;i++)this._setTableValues(g[i],h,n);else{if(g.travIdx===undefined)throw"undefined travIdx";m=n+e;if(g.parentVis){j=m+f;b[h][j].column=g;d[g.travIdx]=j}if(g.isBand)for(i=0,l=g.columns.length;i<l;i++)this._setTableValues(g.columns[i],h+1,n);if(g.parentVis)if(e-m===0){b[h][d[g.travIdx]].rowSpan=c-h;e++}else b[h][d[g.travIdx]].colSpan=e-m;else if(!g.isBand&&c>0){k=this._getVisibleParent(g);o=k?k.isLeaf:false;if(o)f++;if(h>=c)h=c-1;j=n+e+f;b[h][j].column=g;if(!o){k&&d[k.travIdx]===j&&this._shiftTableElements(j,h);f++}}}};this._shiftTableElements=function(c,e){for(var a=0;a<e;a++){b[a][c+1]=b[a][c];b[a][c]={column:null,colSpan:0,rowSpan:0};if(b[a][c+1].column)d[b[a][c+1].column.travIdx]++}}},getAllLeaves:function(b){var a=[];this._getAllLeaves(b,a);return a},_getAllLeaves:function(d,e){var c,f,a,b;if(d)for(c=0,f=d.length;c<f;c++){a=d[c];if(a.options)a=a.options;b=a.columns;if(b&&b.length)this._getAllLeaves(b,e);else e.push(a)}},getColumnByTravIdx:function(b,d){var c,f,a,e=null;if(b&&d>=0)for(c=0,f=b.length;c<f&&!e;c++){a=b[c];if(a.options)a=a.options;if(a.travIdx===d)return{found:a,at:b};if(a.columns)e=this.getColumnByTravIdx(a.columns,d)}return e},isChildOf:function(d,a,b){if(a.options)a=a.options;if(b.options)b=b.options;if(b.isBand&&a.parentIdx>=0){if(a.parentIdx===b.travIdx)return true;if(a.parentIdx>b.travIdx)for(var c=this.flatten(d);;){a=c[a.parentIdx];if(a.travIdx===b.travIdx)return true;if(a.parentIdx===-1)break}}return false},getLeaves:function(b){var a=[];this._getLeaves(b,a);return a},_getLeaves:function(c,d){var b,e,a;if(c)for(b=0,e=c.length;b<e;b++){a=c[b];a.isLeaf&&d.push(a);a.columns&&this._getLeaves(a.columns,d)}},setTraverseIndex:function(a){return this._setTraverseIndex(a,0,-1)},_setTraverseIndex:function(d,b,f){var c,e,a;if(d)for(c=0,e=d.length;c<e;c++){a=d[c];if(a.options)a=a.options;a.linearIdx=c;a.travIdx=b++;a.parentIdx=f;if(a.columns)b=this._setTraverseIndex(a.columns,b,b-1)}return b},flatten:function(b){var a=[];this.traverse(b,function(b){a.push(b)});return a},traverse:function(c,e){var d,f,b;if(c&&a.isFunction(e))for(d=0;d<c.length;d++){b=c[d];if(b.options)b=b.options;f=c.length;e(b,c);if(c.length!==f){d--;continue}b.columns&&this.traverse(b.columns,e)}},getAriaHeaders:function(e,h){var b,g,c,d,f=[];for(b=0,g=e.length;b<g;b++){c=e[b];d="";do d+=escape(c.headerText)+" ";while(c=h[c.parentIdx]);f[b]=a.trim(d)}return f}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{getTableSection:function(a,b){if(a&&!a.nodeType)a=a[0];if(a)switch(b){case 1:return a.tHead;case 2:if(a.tBodies)return a.tBodies[0]||null;break;case 3:return a.tFoot;default:return a}return null},getTableSectionLength:function(a,b){if(a&&!a.nodeType)a=a[0];return a&&(b=this.getTableSection(a,b))?b.rows.length:0},getTableSectionRow:function(a,b,c){if(a&&!a.nodeType)a=a[0];return a&&(b=this.getTableSection(a,b))?b.rows[c]||null:null},readTableSection:function(c,f,h){var e,k,b,i,g,d,j=[],l=function(a){a=a.toLowerCase();return a==="rowspan"||a==="colspan"};if(c&&!c.nodeType)c=c[0];if(c&&(f=this.getTableSection(c,f)))for(e=0,k=f.rows.length;e<k;e++){g=f.rows[e];d=[];if(h){d.rowAttributes=null;d.cellsAttributes=[]}for(b=0,i=g.cells.length;b<i;b++){d[b]=a.trim(g.cells[b].innerHTML);if(h)d.cellsAttributes[b]=a.wijmo.wijgrid.getAttributes(g.cells[b],l)}j[e]=d}return j}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{dataMode:{dom:1,statical:2,remoteStatical:4,dynamical:8},dataStore:function(c){var b=null,n=this,g=false,e=null,d=null,h,m=false,l=false;this.dataMode=function(){return f()};this.dataSource=function(){return b};this.getFieldNames=function(){if(!g)throw"data is not loaded yet";var d=[],e,c;if(b.items&&b.items.length)c=b.items[0];else if(f()===a.wijmo.wijgrid.dataMode.dom&&b.header&&b.header.length)c=b.header[0];c&&a.each(c,function(a){d.push(!isNaN(a)?parseInt(a,10):a)});return d};this.getDataSlice=function(){if(!g)throw"data is not loaded yet";if(!m){m=true;r(e)}if(!l){l=true;if(f()!==a.wijmo.wijgrid.dataMode.dynamical)h=s(e,b.emptyData);else h={data:e,totalRows:b.data.totalRows,totals:b.data.totals||{},emptyData:b.emptyData}}return h};this.load=function(e){if(!b)b=a.proxy(p,this)(c);if(f()===a.wijmo.wijgrid.dataMode.dynamical){e.data=q();if(b.proxy)b.proxy.options.data=a.extend(b.proxy.options.data,e.data);d=null;b.load(e,true)}else if(!g){d=null;b.load(e)}else{i(b,e);j(b,e)}};this.isLoaded=function(){return g};this.updateValue=function(a,c,b){if(!g)throw"data is not loaded yet";this.dataSource().items[a][c]=b};function p(e){var b=null,c=e.options.data,d;if(c===null)b=new wijdatasource({data:e.element,reader:new k(new o),loading:a.proxy(i,this),loaded:a.proxy(j,this)});else if(a.isArray(c))b=new wijdatasource({data:c,reader:new k(new wijarrayreader),loading:a.proxy(i,this),loaded:a.proxy(j,this)});else{b=new wijdatasource(c);b.reader=new k(c.reader);b.loading=a.proxy(function(d,b){a.isFunction(c.loading)&&c.loading(d,b);a.proxy(i,this)(d,b)},this);b.loaded=a.proxy(function(d,b){a.isFunction(c.loaded)&&c.loaded(d,b);a.proxy(j,this)(d,b)},this);if(b.proxy&&b.proxy.options){d=b.proxy.options.error;b.proxy.options.error=function(){t.apply(this,arguments);a.isFunction(d)&&d.apply(this,arguments)}}}return b}function i(d,b){if(n.dataMode()===a.wijmo.wijgrid.dataMode.dynamical||c.options.alwaysParseData)m=false;l=false;h=null;e=null;c._dataLoading(b)}function j(l,o){g=true;var h,m,b,i,j,k,p=f(),n=!d&&c.options.readAttributesFromData;if(!d)d=[];e=[];for(h=0,m=l.items.length;h<m;h++){b=l.items[h];if(n)if(p===a.wijmo.wijgrid.dataMode.dom){d.push({rowAttributes:b.rowAttributes,cellsAttributes:b.cellsAttributes});delete b.rowAttributes;delete b.cellsAttributes}else{k={};for(i in b)if(b.hasOwnProperty(i)&&a.isArray(j=b[i])){k[i]=j[1];b[i]=j[0]}d.push({rowAttributes:{},cellsAttributes:k})}e.push({values:b,originalRowIndex:h,attributes:d[h]})}c._dataLoaded(o)}function t(){c._ajaxError.apply(c,arguments)}function f(){return!b.data||b.data.jquery?a.wijmo.wijgrid.dataMode.dom:b.dynamic===true?a.wijmo.wijgrid.dataMode.dynamical:a.wijmo.wijgrid.dataMode.statical}function r(d){if(d&&d.length){var g=[],j,f,k,h,e,i,b;a.wijmo.wijgrid.traverse(c.options.columns,function(b){a.wijmo.wijgrid.validDataKey(b.dataKey)&&g.push(b)});j=Math.min(g.length,n.getFieldNames().length);for(f=0,k=d.length;f<k;f++){h=d[f];for(e=0;e<j;e++){i=null;b=g[e];if(b&&b.dataParser){i=c._parse(b,h.values[b.dataKey]);h.values[b.dataKey]=i}}}}}function s(b,h){if(b&&b.length){var d=c._prepareFilterRequest(true),f=c._preparePageRequest(true),g=c._prepareSortRequest(true),e=c._prepareTotalsRequest(true),i=(new a.wijmo.wijgrid.dataHelper).getDataSlice(c,b,d,f,g,e);return i}return{data:[],totalRows:0,totals:{},emptyData:h}}function q(){return{filtering:c._prepareFilterRequest(false),paging:c._preparePageRequest(false),sorting:c._prepareSortRequest(false),totals:c._prepareTotalsRequest(false)}}function k(b){this.read=function(c){c.items=null;b&&a.isFunction(b.read)&&b.read(c);if(!a.isArray(c.items)){c.items=[];if(a.isArray(c.data))c.items=c.data;else if(c.data&&a.isArray(c.data.rows))c.items=c.data.rows}if(f()===a.wijmo.wijgrid.dataMode.dynamical)if(!c.data||isNaN(c.data.totalRows))throw"totalRows value is missing";if(!c.items||!a.isArray(c.items))c.items=[]}}function o(){this.read=function(b){b.items=[];if(b&&b.data&&b.data.length){if(a.wijmo.wijgrid.getTableSectionLength(b.data,2)===1&&a(a.wijmo.wijgrid.getTableSectionRow(b.data,2,0)).hasClass("wijmo-wijgrid-emptydatarow"))b.emptyData=a.wijmo.wijgrid.readTableSection(b.data,2);else b.items=a.wijmo.wijgrid.readTableSection(b.data,2,c.options.readAttributesFromData);b.header=a.wijmo.wijgrid.readTableSection(b.data,1);b.data=null}else throw"invalid data source";}}},dataHelper:function(){this.getDataSlice=function(m,e,p,f,r,q){e=b(e,p,m);a.proxy(c,this)(e,r);var l=e.length,g,o,j,h,k,s,i,n={};n=d(e,q,m);if(f){i=Math.ceil(l/f.pageSize)||1;if(f.pageIndex>=i)f.pageIndex=i-1;g=Math.min(e.length-1,f.pageIndex*f.pageSize);if(g<0)g=0;o=Math.min(e.length,g+f.pageSize);j=[];for(h=g,s=0,k=0;h<o;h++,k++)j[k]=e[h];e=j}return{data:e,totalRows:l,totals:n}};function d(i,f){var b,c,e,j,g,d=[],h={};for(b=0,c=f.length;b<c;b++)d.push(new a.wijmo.wijgrid.tally);for(b=0,c=i.length;b<c;b++){g=i[b].values;for(e=0,j=d.length;e<j;e++)d[e].add(g[f[e].column.dataKey])}for(b=0,c=d.length;b<c;b++)h[f[b].column.dataKey]=d[b].getValueString(f[b].column);return h}function b(e,c,l){if(!e||!e.length||!c||!c.length)return e;a.each(c,function(c,b){if(!a.isArray(b.filterOperator))b.filterOperator=[b.filterOperator];if(!a.isArray(b.filterValue))b.filterValue=[b.filterValue];a.each(b.filterOperator,function(c,a){if(typeof a==="string")b.filterOperator[c]=a={name:a,condition:"or"};b.filterOperator[c].name=l.filterOperatorsCache.getByName(a.name)});a.each(b.filterValue,function(d,c){if(!a.isArray(c))b.filterValue[d]=l._parse(b.column,c);else a.each(c,function(d,a){c[d]=l._parse(b.column,a)})})});var h,i,b,o,m,j,p=[],n,g,q=c.length,d,f,k;for(h=0,o=e.length;h<o;h++){m=e[h];n=true;for(i=0;i<q;i++){d=c[i];j=m.values[d.column.dataKey];g=false;for(b=0;b<d.filterOperator.length;b++){f=d.filterOperator[b];k=d.filterValue[b];if(b>0&&f.condition==="and")g&=f.name.operator(j,k);else g|=f.name.operator(j,k)}n&=g}n&&p.push(m)}return p}function c(i,e){if(e.length){var b=[],d,h,c,a,f,g;b.push("var context = this;");b.push("this.sort = function(a, b)\n{\n");for(d=0,h=e.length;d<h;d++){c="arg"+d;a=e[d];f=typeof a.dataKey==="string"?'"'+a.dataKey+'"':a.dataKey;if(a.sortDirection==="ascending"||a.sortDirection==="descending")if(a.sortDirection==="ascending")b.push("var ",c," = context._sortAsc","(a.values[",f,"], b.values[",f,"]);\n");else b.push("var ",c," = context._sortDesc","(a.values[",f,"], b.values[",f,"]);\n");else b.push("var ",c," = context._sortDigitAsc","(a.originalRowIndex, b.originalRowIndex);\n");b.push("if (",c," === 0)\n");b.push("{\n")}g=e.length-1;if(g>=0){c="arg"+g;a=e[g];f=typeof a.dataKey==="string"?'"'+a.dataKey+'"':a.dataKey;if(a.sortDirection==="ascending"||a.sortDirection==="descending")if(a.sortDirection==="ascending")b.push("var ",c," = context._sortDigitAsc","(a.originalRowIndex, b.originalRowIndex);\n");else b.push("var ",c," = context._sortDigitDesc","(a.originalRowIndex, b.originalRowIndex);\n")}for(d=e.length-1;d>=0;d--){b.push("}\n");c="arg"+d;b.push("return ",c,";\n")}b.push("}");eval(b.join(""));i.sort(this.sort)}}this._sortAsc=function(a,b){if(a instanceof Date)a=a.getTime();if(b instanceof Date)b=b.getTime();return a===b?0:a===null?-1:b===null?1:a<b?-1:1};this._sortDesc=function(a,b){if(a instanceof Date)a=a.getTime();if(b instanceof Date)b=b.getTime();return a===b?0:a===null?1:b===null?-1:a<b?1:-1};this._sortDigitAsc=function(a,b){return a-b};this._sortDigitDesc=function(a,b){return b-a}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{groupRange:function(f,h,i,g,e){this.value=-1;this.isExpanded=false;this.cr=new a.wijmo.wijgrid.cellRange(-1,-1);this.sum=-1;this.position="none";this.hasHeaderOrFooter=true;if(f!==undefined)this.isExpanded=f;if(h!==undefined)this.cr=h;if(i!==undefined)this.sum=i;if(g!==undefined)this.position=g;if(e!==undefined)this.hasHeaderOrFooter=e;this.isSubRange=function(a){return this.cr.r1>=a.cr.r1&&this.cr.r2<=a.cr.r2};this.toString=function(){return this.cr.r1+"-"+this.cr.r2};this._getHeaderImageClass=function(c){var b=this.owner;return b?c?b.expandedImageClass||a.wijmo.c1field.prototype.options.groupInfo.expandedImageClass:b.collapsedImageClass||a.wijmo.c1field.prototype.options.groupInfo.collapsedImageClass:null};this.collapse=function(){var b,g,e,c,d,f;if((b=this.owner)&&(g=b.owner)&&(e=g.owner)){c=new a.wijmo.wijgrid.groupHelper;d=e._field("leaves");if(c.isParentExpanded(d,this.cr,b.level))if(b.position!=="footer"&&b.outlineMode!=="none"){f=c.getGroupedColumnsCount(d);j(c,e._rows(),d,this,f)}}};this.expand=function(i){var e,h,f,b,c,g;if((e=this.owner)&&(h=e.owner)&&(f=h.owner)){b=new a.wijmo.wijgrid.groupHelper;c=f._field("leaves");if(b.isParentExpanded(c,this.cr,e.level)){g=b.getGroupedColumnsCount(c);d(b,f._rows(),c,this,g,i,true)}}};function j(m,e,o,d,l){var j=d.owner,i=d.cr.r1,n=d.cr.r2,a,k,h,f,g;switch(j.position){case"header":case"headerAndFooter":b(e.item(d.cr.r1),undefined,false);i++}for(a=i;a<=n;a++)b(e.item(a),false);d.isExpanded=false;c(e,d);for(a=j.level+1;a<=l;a++){h=m.getChildGroupRanges(o,d.cr,a-1);for(g=0,k=h.length;g<k;g++){f=h[g];f.isExpanded=false;switch(f.owner.position){case"header":case"headerAndFooter":b(e.item(f.cr.r1),undefined,false)}c(e,f)}}}function d(o,e,p,g,n,k,l){var r=g.owner,h=g.cr.r1,j=g.cr.r2,a,m,f,i,q;switch(r.position){case"header":b(e.item(h),true,l||k);h++;break;case"footer":b(e.item(j),true);j--;break;case"headerAndFooter":b(e.item(h),true,l||k);l&&b(e.item(j),true);h++;j--}if(l){g.isExpanded=true;c(e,g)}else return;if(g.owner.level===n)for(a=h;a<=j;a++)b(e.item(a),true);else{f=o.getChildGroupRanges(p,g.cr,g.owner.level);if(f.length&&h!==f[0].cr.r1)for(a=h;a<f[0].cr.r1;a++)b(e.item(a),true);if(k)for(a=0,m=f.length;a<m;a++){i=f[a];d(o,e,p,i,n,k,true)}else for(a=0,m=f.length;a<m;a++){i=f[a];q=i.owner.position==="footer"||i.owner.outlineMode==="none"?true:false;d(o,e,p,i,n,false,q)}}}function b(a,b,c){if(a){if(a[0]){if(b!==undefined){a[0].style.display=b?"":"none";a[0]["aria-hidden"]=b?"false":"true"}if(c!==undefined)a[0]["aria-expanded"]=c?"true":false}if(a[1]){if(b!==undefined){a[1].style.display=b?"":"none";a[1]["aria-hidden"]=b?"false":"true"}if(c!==undefined)a[1]["aria-expanded"]=c?"true":false}}}function c(e,b){if(b.owner.position!=="footer"){var c=null,d=e.item(b.cr.r1);if(d)if(d[0])c=a(d[0]).find("div.wijmo-wijgrid-grouptogglebtn:first-child");if(c&&c.length){c.toggleClass(b._getHeaderImageClass(!b.isExpanded),false);c.toggleClass(b._getHeaderImageClass(b.isExpanded),true)}}}},grouper:function(){this.group=function(i,k,e){this._grid=i;this._data=k;this._leaves=e;this._groupRowIdx=0;this._groupHelper=new a.wijmo.wijgrid.groupHelper;var h=1,c,f,b,d=[],g=false,j=0;for(c=0,f=e.length;c<f;c++){b=e[c];if(b.groupInfo){delete b.groupInfo.level;delete b.groupInfo.expandInfo}if(b.groupInfo&&b.groupInfo.position&&b.groupInfo.position!=="none"&&b.dataIndex>=0){if(b.groupedIndex===undefined)g=true}else if(b.groupedIndex!==undefined)delete b.groupedIndex}if(g)for(c=0,f=e.length;c<f;c++){b=e[c];if(b.groupInfo&&b.groupInfo.position&&b.groupInfo.position!=="none"&&b.dataIndex>=0){b.groupedIndex=j++;d.push(b)}}else{d=a.map(e,function(a){return a.groupedIndex!==undefined?a:null});d.sort(function(a,b){return a.groupedIndex-b.groupedIndex});a.each(d,function(a,b){b.groupedIndex=a})}i._field("groupedColumns",d);for(c=0,f=d.length;c<f;c++){b=d[c];this._groupRowIdx=0;if(b.groupInfo&&b.groupInfo.position&&b.groupInfo.position!=="none"&&b.dataIndex>=0){b.groupInfo.level=h;b.groupInfo.expandInfo=[];this._processRowGroup(b,h++)}}delete this._grid;delete this._data;delete this._leaves};this._processRowGroup=function(j,c){var k,b,i,o,m,d,h,e,g,f,n=0,l=true;a.each(this._leaves,function(b,a){if(a.parentVis){n=b;return false}});for(k=0;k<this._data.length;k++){if(!(this._data[k].rowType&a.wijmo.wijgrid.rowType.data))continue;b=this._getGroupCellRange(k,j,c);i=true;o=j.groupInfo.outlineMode==="startCollapsed";if(o||this._groupHelper.isParentCollapsed(this._leaves,b,c)){if(j.groupInfo.groupSingleRow===false&&b.r1===b.r2)continue;i=false}if(c&&this._grid.options.groupIndent)for(m=b.r1;m<=b.r2;m++)this._addIndent(this._data[m][n],c);l=!(j.groupInfo.groupSingleRow===false&&b.r1===b.r2);switch(j.groupInfo.position){case"header":d=this._addGroupRange(j.groupInfo,b,i,l);for(f=b.r1;f<=b.r2;f++){this._data[f].__attr["aria-level"]=c+1;if(!i){this._data[f].__style.display="none";this._data[f].__attr["aria-hidden"]=true}}if(!l)break;this._updateByGroupRange(d,c);h=this._groupHelper.isParentCollapsed(this._leaves,d.cr,c);e=this._buildGroupRow(d,b,true,h);this._data.splice(b.r1,0,e);e.__attr["arial-level"]=c;e.__attr["aria-expanded"]=i;if(h){e.__style.display="none";e.__attr["aria-hidden"]=true}k=b.r2+1;break;case"footer":d=this._addGroupRange(j.groupInfo,b,true,l);if(!l)break;this._updateByGroupRange(d,c);g=this._buildGroupRow(d,b,false,false);g.__attr["aria-level"]=c;this._data.splice(b.r2+1,0,g);k=b.r2+1;h=this._groupHelper.isParentCollapsed(this._leaves,d.cr,c);if(h){g.__style.display="none";g.__attr["aria-hidden"]=true}break;case"headerAndFooter":d=this._addGroupRange(j.groupInfo,b,i,l);for(f=b.r1;f<=b.r2;f++){this._data[f].__attr["aria-level"]=c+1;if(!i){this._data[f].__style.display="none";this._data[f].__attr["aria-hidden"]=true}}if(!l)break;this._updateByGroupRange(d,c);h=this._groupHelper.isParentCollapsed(this._leaves,d.cr,c);e=this._buildGroupRow(d,b,true,h);g=this._buildGroupRow(d,b,false,false);this._data.splice(b.r2+1,0,g);g.__attr["aria-level"]=c;if(h||!i){g.__style.display="none";g.__attr["aria-hidden"]=true}this._data.splice(b.r1,0,e);e.__attr["aria-level"]=c;e.__attr["aria-expanded"]=i;if(h){e.__style.display="none";e.__attr["aria-hidden"]=true}k=b.r2+2;break;default:throw a.wijmo.wijgrid.stringFormat('Unknown Position value: "{0}"',j.groupInfo.position);}this._groupRowIdx++}};this._buildGroupRow=function(n,l,f){var e=n.owner,c=e.owner,r=c.owner,h=[],j="",k="",d,g,b,p,q,i,o,m;h.__style={};h.__attr={};h.__attr.id=(f?"GH":"GF")+this._groupRowIdx+"-"+e.level;h.rowType=f?a.wijmo.wijgrid.rowType.groupHeader:a.wijmo.wijgrid.rowType.groupFooter;if(c.dataIndex>=0&&(d=this._data[l.r1][c.dataIndex].value)!==null)j=r._toStr(c,d);this._grid.options.showRowHeader&&h.push({html:"&nbsp;"});g={html:"",__attr:{},__style:{}};if(f&&e.outlineMode!=="none")if(n.isExpanded)g.html='<div class="ui-icon '+n._getHeaderImageClass(true)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>';else g.html='<div class="ui-icon '+n._getHeaderImageClass(false)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>';h.push(g);if(c.aggregate&&c.aggregate!=="none")k=this._getAggregate(l,c,c,f,j);b=f?e.headerText:e.footerText;if(b==="custom"){p={data:this._data,column:c,groupByColumn:e.owner,groupText:j,text:"",groupingStart:l.r1,groupingEnd:l.r2,isGroupHeader:f,aggregate:k};if(this._grid._trigger("groupText",null,p))b=p.text}else{if(b===undefined||b===null){if(f)b="{1}: {0}";if(k||k===0)b=b?b+" {2}":"{2}"}b=a.wijmo.wijgrid.stringFormat(b,j,c&&c.headerText?c.headerText:"",k.toString())}if(!b)b="&nbsp;";g.html+="<span>"+b+"</span>";this._addIndent(g,e.level-1);q=1;i=this._grid.options.showRowHeader?1:0;o=true;for(;i<this._leaves.length;i++){d=this._leaves[i];if(d.parentVis){if(o){o=false;continue}if(d.dynamic!==true&&d.aggregate&&d.aggregate!=="none")break;q++}}for(;i<this._leaves.length;i++){d=this._leaves[i];if(d.parentVis){m=this._getAggregate(l,d,e.owner,f,j);if(!m&&m!==0)m="&nbsp;";h.push({html:m.toString(),__attr:{groupInfo:{leafIndex:d.leavesIdx,purpose:a.wijmo.wijgrid.groupRowCellPurpose.aggregateCell}}})}}g.__attr.colSpan=q;g.__attr.groupInfo={leafIndex:c.leavesIdx,purpose:a.wijmo.wijgrid.groupRowCellPurpose.groupCell};return h};this._getAggregate=function(d,b,h,i,j){var c="",g,f,e;if(!b.aggregate||b.aggregate==="none")return c;if(b.aggregate==="custom"){g={data:this._data,column:b,groupByColumn:h,groupText:j,text:"",groupingStart:d.r1,groupingEnd:d.r2,isGroupHeader:i};if(this._grid._trigger("groupAggregate",null,g))c=g.text}else{f=new a.wijmo.wijgrid.tally;for(e=d.r1;e<=d.r2;e++)f.add(this._data[e][b.dataIndex].value);c=f.getValueString(b)}return c};this._getGroupCellRange=function(e,f,i){var j=f.leavesIdx,b=new a.wijmo.wijgrid.cellRange(e,j),g=this._groupHelper.getParentGroupRange(this._leaves,b,i),d,c,h;if(this._data[e].rowType&a.wijmo.wijgrid.rowType.data){d=this._data[e][f.dataIndex].value;if(d instanceof Date)d=d.getTime();for(b.r2=e,h=this._data.length-1;b.r2<h;b.r2++){if(!(this._data[b.r2+1].rowType&a.wijmo.wijgrid.rowType.data)||g&&b.r2+1>g.r2)break;c=this._data[b.r2+1][f.dataIndex].value;if(c instanceof Date)c=c.getTime();if(d!==c)break}}return b};this._addGroupRange=function(b,c,j,f){var d=null,g=this._groupHelper.getChildGroupIndex(c,b.expandInfo),i,h,k,e;if(g>=0&&g<b.expandInfo.length)d=b.expandInfo[g];else{i=new a.wijmo.wijgrid.cellRange(c.r1,c.r1,c.r2,c.r2);h=b.position==="footer"||!f?true:j&&b.outlineMode!=="startCollapsed";d=new a.wijmo.wijgrid.groupRange(h,i,-1,b.position,f);d.owner=b;b.expandInfo.push(d)}if(d&&f){k=c.r1;e=c.r2;if(b.position==="headerAndFooter")e+=2;if(b.position!=="headerAndFooter")e++;d.cr.r2=e}return d};this._updateByGroupRange=function(c,i){var d,h,b,g,e,a,f;for(d=0,h=this._leaves.length;d<h;d++){b=this._leaves[d].groupInfo;if(b&&b.level<i){g=b.expandInfo?b.expandInfo.length:0;for(e=0;e<g;e++){a=b.expandInfo[e];f=c.position==="headerAndFooter"?2:1;if(a.cr.r1>=c.cr.r1&&!(a.cr.r1===c.cr.r1&&a.position==="footer"))a.cr.r1+=f;if(a.cr.r2>=c.cr.r1)a.cr.r2+=f}}}};this._addIndent=function(c,b){var a;if(b>0&&(a=this._grid.options.groupIndent))c.__style.paddingLeft=a*b+"px"}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{_getGroupInfoRegExp:/.*G([HF]){1}(\d+)-(\d+)$/,groupHelper:function(){this.getGroupInfo=function(d){if(d){var b=a.wijmo.wijgrid._getGroupInfoRegExp.exec(d.id),f,e,c;if(b){f=parseInt(b[3],10);e=parseInt(b[2],10);c=b[1]==="H";return{level:f,index:e,isHeader:c,toString:function(){return(this.isHeader?"GH":"GF")+this.index+"-"+this.level}}}}return null};this.getColumnByGroupLevel=function(c,e){var b,d,a;for(b=0,d=c.length;b<d;b++){a=c[b];if(a.groupInfo&&a.groupInfo.level===e)return a}return null};this.getGroupedColumnsCount=function(c){var d=0,b,e,a;for(b=0,e=c.length;b<e;b++){a=c[b].groupInfo;if(a&&(a.position==="header"||a.position==="headerAndFooter"||a.position==="footer"))d++}return d};this.getChildGroupIndex=function(f,e){var b=0,c=e.length-1,a,d;while(b<=c){a=(c-b>>1)+b;d=e[a].cr.r1-f.r1;if(d===0)return a;if(d<0)b=a+1;else c=a-1}return b};this.getParentGroupIndex=function(c,b){var a=this.getChildGroupIndex(c,b);if(a>0)a--;return a<b.length?a:-1};this.getChildGroupRanges=function(i,f,j){var g=[],a,c,b,h,e,d=this.getColumnByGroupLevel(i,j+1);if(d){a=d.groupInfo.expandInfo;e=this.getChildGroupIndex(f,a);for(b=e,h=a.length;b<h;b++){c=a[b];if(c.cr.r2<=f.r2)g.push(c);else break}}return g};this.getParentGroupRange=function(e,f,b){var c,a,d;if(b===undefined)b=65535;if(b-2>=0)for(c=e.length-1;c>=0;c--){a=e[c].groupInfo;if(!a||!a.expandInfo||a.level<0||a.level!==b-1)continue;d=this.getParentGroupIndex(f,a.expandInfo);if(d>=0)return a.expandInfo[d]}return null};this.isParentCollapsed=function(e,c,d){var b,a;if(d===1)return false;for(b=d;b>1;b--){a=this.getParentGroupRange(e,c,b);if(a&&!a.isExpanded)return true;c=a.cr}return false};this.isParentExpanded=function(e,c,d){var b,a;if(d===1)return true;for(b=d;b>1;b--){a=this.getParentGroupRange(e,c,b);if(a&&a.isExpanded)return true;c=a.cr}return false}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{cellRange:function(b,a,d,c){switch(arguments.length){case 2:this.r1=this.r2=b;this.c1=this.c2=a;break;case 4:this.r1=b;this.r2=d;this.c1=a;this.c2=c;break;default:this.r1=0;this.r2=0;this.c1=0;this.c2=0}this.isSingleCell=function(){return this.r1===this.r2&&this.c1===this.c2}},merger:function(){this.merge=function(e,c){this.leaves=c;this.data=e;var b,d,a;for(b=0,d=c.length;b<d;b++){a=c[b];a.dataIndex>=0&&!a.isBand&&(a.rowMerge==="free"||a.rowMerge==="restricted")&&this.mergeColumn(a)}delete this.data;delete this.leaves};this.mergeColumn=function(f){var e=f.dataIndex,c,h,b,g,d;for(c=0,h=this.data.length;c<h;c++){if(!(this.data[c].rowType&a.wijmo.wijgrid.rowType.data))continue;b=this.getCellRange(c,f);if(b.r1!==b.r2){g=b.r2-b.r1+1;this.data[b.r1][e].__attr.rowSpan=g;for(d=b.r1+1;d<=b.r2;d++)this.data[d][e].visible=false}c=b.r2}};this.getCellRange=function(c,h){var d=h.dataIndex,b=new a.wijmo.wijgrid.cellRange(c,d),k=(this.data[c][d].value||"").toString(),j=this.data.length,e,g,f,i;for(b.r2=c;b.r2<j-1;b.r2++){e=this.data[b.r2+1];if(!(e.rowType&a.wijmo.wijgrid.rowType.data)||(e[d].value||"").toString()!==k)break}g=h.leavesIdx;if(g>0&&h.rowMerge==="restricted"){f=this.leaves[g-1];if(f.dataIndex>=0){i=this.getCellRange(c,f);b.r1=Math.max(b.r1,i.r1);b.r2=Math.min(b.r2,i.r2)}}return b}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{rowType:{header:1,data:2,dataAlt:4,filter:8,groupHeader:16,groupFooter:32,footer:64,emptyDataRow:128,fooRow:65536},renderState:{none:0,rendering:1,current:2,hovered:4,selected:8},groupRowCellPurpose:{groupCell:0,aggregateCell:1},stringFormat:function(b){var a,c;if(!b)return"";for(a=1,c=arguments.length;a<c;a++)b=b.replace(new RegExp("\\{"+(a-1)+"\\}","gm"),arguments[a]);return b},validDataKey:function(a){return a&&!(a<0)||a===0},iterateChildrenWidgets:function(b,c){if(b&&c){if(b.nodeType)b=a(b);b.find(".ui-widget").each(function(b,d){a.each(a(d).data(),function(d,a){a.widgetName&&c(b,a)})})}},remove$dataByPrefix:function(c,d){var b=[];a.each(c.data(),function(a){a.indexOf(d)===0&&b.push(a)});a.each(b,function(b,a){c.removeData(a)})},domSelection:function(b){this.getSelection=function(){var a=0,c=0,d;if(b.selectionStart!==undefined){a=b.selectionStart;c=b.selectionEnd}else if(document.selection){d=document.selection.createRange().duplicate();c=d.text.length;a=Math.abs(d.moveStart("character",-b.value.length));c+=a}return{start:a,end:c,length:c-a}};this.setSelection=function(c){if(b.selectionStart!==undefined)b.setSelectionRange(c.start,c.end);else{var a=b.createTextRange();a.collapse(true);a.moveStart("character",c.start);a.moveEnd("character",c.end);a.select()}};this.toggleSelection=function(c){if(c)a(b).enableSelection().css({MozUserSelect:"",WebkitUserSelect:""});else a(b).disableSelection().css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})}},createDynamicField:function(b){return a.extend(true,{},a.wijmo.c1basefield.prototype.options,a.wijmo.c1field.prototype.options,{dynamic:true,isLeaf:true,isBand:false,parentIdx:-1},b)},bounds:function(d,e){if(d){var c=d.nodeType?a(d):d,b=c.offset();if(b)return e?{top:b.top,left:b.left,width:c[0].clientWidth||0,height:c[0].clientHeight||0}:{top:b.top,left:b.left,width:c.outerWidth(),height:c.outerHeight()}}return null},_getDOMText:function(a,c,b){if(b===undefined)b=0;if(a&&(!c||c&&b<3))if(a.nodeType===3)return a.nodeValue;else if(a.nodeType===1){switch(a.type){case"button":case"text":case"textarea":case"select-one":return a.value;case"checkbox":return a.checked.toString()}for(var e="",d=0;a.childNodes[d];d++)e+=this._getDOMText(a.childNodes[d],c,b+1);return e}return""},rowTypeFromCss:function(b){var c=/wijmo-wijgrid-(\S+)row/.exec(b.attr("class"));if(c)switch(c[1]){case"header":return a.wijmo.wijgrid.rowType.header;case"filter":return a.wijmo.wijgrid.rowType.filter;case"data":return b.hasClass("wijmo-wijgrid-alternatingrow")?a.wijmo.wijgrid.rowType.data|a.wijmo.wijgrid.rowType.dataAlt:a.wijmo.wijgrid.rowType.data;case"alternating":return a.wijmo.wijgrid.rowType.data|a.wijmo.wijgrid.rowType.dataAlt;case"groupheader":return a.wijmo.wijgrid.rowType.groupHeader;case"groupfooter":return a.wijmo.wijgrid.rowType.groupFooter}},dataPrefix:function(b,i,j,f){var e=b.jquery||a.isArray(b),d,g,h,c=i+j;if(arguments.length===3)return e?a.data(b[0],c):a.data(b,c);else{if(e){for(d=0,g=b.length;d<g;d++)h=a.data(b[d],c,f);return h}return a.data(b,c,f)}},shallowMerge:function(d,c){if(c&&d){var a,e,b;for(a in c)if(c.hasOwnProperty(a)){e=c[a];b=typeof e;if((b==="string"||b==="boolean"||b==="number")&&d[a]===undefined)d[a]=e}}},isCustomObject:function(a){return a&&typeof a==="object"&&!(a instanceof Date)},search:function(c,d){var b,e,f=a.isFunction(d);for(b in c)if(c.hasOwnProperty(b)){e=f?d(c[b]):c[b]===d;if(e===true)return{at:b,found:c[b]}}return{at:null,found:null}},getAttributes:function(c,e){if(c){var d,h,g=0,f={},a,b;for(d=0,h=c.attributes.length;d<h;d++){b=c.attributes[d].name;if(b&&(!e||!e(b))){a=c.getAttribute(b);if(b==="style")a=typeof a==="object"?a.cssText:a;if(!a&&b==="class")a=c.getAttribute("className");if(a&&typeof a!=="function"){f[b]=a;g++}}}if(g)return f}return null}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{embeddedParsers:{stringParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(a,d,e,c,b){switch(a){case null:return null;case c:if(b)return null;case undefined:case"&nbsp;":return"";default:return""+a}},toStr:function(a,d,e,c,b){return a===null&&b?c:""+a}},numberParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(a,d,f,c,b){var e=typeof a;return e==="number"?isNaN(a)?NaN:a:!a&&a!==0||a==="&nbsp;"||a===c&&b?null:Globalize.parseFloat(a,10,d.name)},toStr:function(a,d,e,c,b){return a===null&&b?c:Globalize.format(a,e||"n",d.name)}},currencyParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(a,b,f,e,d){var c=typeof a;if(c==="number")return isNaN(a)?NaN:a;if(!a&&a!==0||a==="&nbsp;"||a===e&&d)return null;if(c==="string")a=a.replace(b.numberFormat.currency.symbol,"");return Globalize.parseFloat(a,10,b.name)},toStr:function(a,d,e,c,b){return a===null&&b?c:Globalize.format(a,e||"c",d.name)}},dateTimeParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(a,f,g,e,d){var c,b;if(a instanceof Date)return a;if(!a||a==="&nbsp;"||a===e&&d)return null;c=/^\/Date\((\d+)\)\/$/.exec(a);if(c)return new Date(parseInt(c[1],10));b=Globalize.parseDate(a,g,f.name);if(b==null||isNaN(b)){b=Date.parse(a);b=isNaN(b)?NaN:new Date(b)}return b},toStr:function(a,d,e,c,b){return a===null&&b?c:Globalize.format(a,e||"d",d.name)}},boolParser:{parseDOM:function(f,d,e,c,b){return this.parse(a.wijmo.wijgrid._getDOMText(f,true),d,e,c,b)},parse:function(b,f,g,e,d){var c=typeof b;if(c==="boolean")return b;if(c==="string")b=a.trim(b);if(!b||b==="&nbsp;"||b===e&&d)return null;switch(b.toLowerCase()){case"true":return true;case"false":return false}return NaN},toStr:function(a,d,e,c,b){return a===null&&b?c:a?"true":"false"}}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{filterOperatorsCache:function(){var b={};this.add=function(a){if(a&&a.name&&a.operator){var c=a.name.toLowerCase();if(!b[c])b[c]=a}};this.clear=function(){b.length=0};this.getByName=function(a){return b[a.toLowerCase()]};this.getByDataType=function(f){var e=[],d,c;for(d in b)if(b.hasOwnProperty(d)){c=b[d];a.inArray(f,c.applicableTo)>=0&&e.push(c)}return e};this.removeCustom=function(){var a;for(a in b)if(b[a].custom)delete b[a]};this.sort=function(a,b){switch(b.toLowerCase()){case"alphabetical":a.sort(e);break;case"alphabeticalcustomfirst":a.sort(d);break;case"alphabeticalembeddedFirst":a.sort(c)}return a};function e(c,d){var a=c.name.toLowerCase(),b=d.name.toLowerCase();if(a!==b){if(a==="nofilter")return-1;if(b==="nofilter")return 1}return a===b?0:a<b?-1:1}function c(c,d){var a=c.name.toLowerCase(),b=d.name.toLowerCase();if(a!==b){if(a==="nofilter")return-1;if(b==="nofilter")return 1}if(c.custom!==d.custom){if(c.custom)return 1;if(d.custom)return-1}return a===b?0:a<b?-1:1}function d(c,d){var a=c.name.toLowerCase(),b=d.name.toLowerCase();if(a!==b){if(a==="nofilter")return-1;if(b==="nofilter")return 1}if(c.custom!==d.custom){if(c.custom)return-1;if(d.custom)return 1}return a===b?0:a<b?-1:1}}});a.wijmo.wijgrid.embeddedFiltersImpl={_anyCmp:function(c,d,h){var e,g,b,f=false;if(!a.isArray(d))d=[d];if(!(g=d.length))return false;if(c instanceof Date)c=c.getTime();if(typeof c==="string")c=c.toLowerCase();for(e=0;e<g&&!f;e++){b=d[e];if(b instanceof Date)b=b.getTime();if(typeof b==="string")b=b.toLowerCase();f=h(c,b)}return f}};a.wijmo.wijgrid.embeddedFilters={nofilter:{name:"NoFilter",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(){return true}},contains:{name:"Contains",arity:2,applicableTo:["string"],operator:function(c,b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(c,b,function(a,b){return a===b||(a?a.indexOf(b)>=0:false)})}},notcontain:{name:"NotContain",arity:2,applicableTo:["string"],operator:function(c,b){return!a.wijmo.wijgrid.embeddedFilters.contains.operator(c,b)}},beginswith:{name:"BeginsWith",arity:2,applicableTo:["string"],operator:function(c,b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(c,b,function(a,b){return a===b||(a?a.indexOf(b)===0:false)})}},endswith:{name:"EndsWith",arity:2,applicableTo:["string"],operator:function(c,b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(c,b,function(a,b){var c=a===b,d;if(!c&&a){d=a.lastIndexOf(b);if(d>=0)c=a.length-d===b.length}return c})}},equals:{name:"Equals",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(c,b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(c,b,function(b,a){return b===a})}},notequal:{name:"NotEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(c,b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(c,b,function(b,a){return b!==a})}},greater:{name:"Greater",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(c,b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(c,b,function(b,a){return b>a})}},less:{name:"Less",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(c,b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(c,b,function(b,a){return b<a})}},greaterorequal:{name:"GreaterOrEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(c,b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(c,b,function(b,a){return b>=a})}},lessorequal:{name:"LessOrEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(c,b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(c,b,function(b,a){return b<=a})}},isempty:{name:"IsEmpty",arity:1,applicableTo:["string"],operator:function(b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,undefined,function(a){return!a&&a!==0&&a!==false})}},notisempty:{name:"NotIsEmpty",arity:1,applicableTo:["string"],operator:function(b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,undefined,function(a){return!!a||a===0||a===false})}},isnull:{name:"IsNull",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,undefined,function(a){return a===null})}},notisnull:{name:"NotIsNull",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b){return a.wijmo.wijgrid.embeddedFiltersImpl._anyCmp(b,undefined,function(a){return a!==null})}}}})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{filterHelper:{getSingleValue:function(b){if(a.isArray(b)){b=b[0];if(a.isArray(b))b=b[0]}return b},getSingleOperatorName:function(b){if(a.isArray(b))b=b[0];return b.name||b||""},verify:function(b,d,f,g){if(b)if(a.isArray(b)){var c,i,e=[],h=[];if(!a.isArray(d))d=[d];for(c=0,i=b.length;c<i;c++)if(this._verifySingleOp(b[c],d[c],f,g)){e.push({name:b[c].name||b[c],condition:b[c].condition||"or"});h.push(d?d[c]:undefined)}if(e.length)return{filterOperator:e,filterValue:h}}else if(this._verifySingleOp(b,d,f,g))return{filterOperator:b,filterValue:d};return null},_verifySingleOp:function(b,d,e,f){if(b&&(b=b.name||b)){var c;b=(b||"").toLowerCase();if(b!=="nofilter"&&(c=f.getByName(b)))if(a.inArray(e||"string",c.applicableTo)>=0)if(c.arity===1||c.arity>1&&this.getSingleValue(d)!==undefined)return true}return false}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{htmlTableAccessor:function(e,i,h,f){var d=[],c=0,b=e;function g(){var f=[],e,h,n,k,g,a,m,j,l,i;for(h=0,n=b.rows.length;h<n;h++){e=[];d[h]=e;k=b.rows[h];for(g=0,a=0,m=k.cells.length;g<m;g++,a++){j=k.cells[g];for(;f[a]>1;a++){f[a]--;e[a]={cellIdx:-1,colIdx:-1}}if(!(f[a]>1))f[a]=j.rowSpan;e[a]={cellIdx:g,colIdx:-1};e[g].colIdx=a;l=j.colSpan;for(;l>1;l--)e[++a]={cellIdx:-1,colIdx:-1}}i=f.length;for(;a<i;a++){f[a]--;e[a]={cellIdx:-1,colIdx:-1}}c=Math.max(c,i)}}this.element=function(){return e};this.width=function(){return c};this.getCellIdx=function(a,b){return a<c?d[b][a].cellIdx:-1};this.getColumnIdx=function(a,e){if(typeof a!=="number"){var b=a;a=b.cellIndex;e=b.parentNode.rowIndex}return a<c?d[e][a].colIdx:-1};this.getSectionLength=function(c){return a.wijmo.wijgrid.getTableSectionLength(b,c)};this.getSectionRow=function(c,d){return a.wijmo.wijgrid.getTableSectionRow(b,d,c)};this.forEachColumnCellNatural=function(c,g,h){var a,f,e,d;for(a=0,f=b.rows.length;a<f;a++){e=b.rows[a];if(c<e.cells.length){d=g(e.cells[c],c,h);if(d!==true)return d}}return true};this.forEachColumnCell=function(h,i,j){var a,f,g,c,e;for(a=0,f=d.length;a<f;a++){g=b.rows[a];c=this.getCellIdx(h,a);if(c>=0){e=i(g.cells[c],a,j);if(e!==true)return e}}return true};this.forEachRowCell=function(g,f,h){var e=b.rows[g],a,d,c;for(a=0,d=e.cells.length;a<d;a++){c=f(e.cells[a],a,h);if(c!==true)return c}return true};this.colGroupTag=function(){var a=b.getElementsByTagName("colgroup");return a&&a[0]||null};this.colTags=function(){var a=this.colGroupTag();return a&&a.getElementsByTagName("col")||[]};this.ensureTBody=function(){return b.tBodies&&b.tBodies[0]||b.appendChild(document.createElement("tbody"))};this.ensureTHead=function(){return b.tHead&&b.tHead[0]||b.createTHead()};this.ensureTFoot=function(){return b.tFoot&&b.tFoot[0]||b.createTFoot()};this.ensureColGroup=function(){var a=b.getElementsByTagName("colgroup");return a&&a[0]||b.appendChild(document.createElement("colgroup"))};this.appendCol=function(b){var a=this.ensureColGroup();return b&&a.appendChild(b)||a.appendChild(document.createElement("col"))};f&&this.ensureColGroup();h&&this.ensureTBody();!i&&g()}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.cellInfo=function(d,c){var e=false,b=null;this.cellIndex=function(a){if(arguments.length===0)return d;d=a};this.column=function(){if(b&&this._isValid()){var a=b._getDataToAbsOffset();return b._field("visibleLeaves")[d+a.x]}return null};this.container=function(){var c=this.tableCell(),b;if(c){b=a(c).children("div.wijmo-wijgrid-innercell");if(b)return b}return null};this.isEqual=function(a){return a&&a.rowIndex()===c&&a.cellIndex()===d};this.row=function(){var a=this._row();if(a!==null){a=b._view()._getRowInfo(a);return a}return null};this.rowIndex=function(a){if(arguments.length===0)return c;c=a};this.tableCell=function(){if(b&&this._isValid()){var a=b._getDataToAbsOffset();return b._view().getCell(d+a.x,c+a.y)}return null};this.value=function(e){var d,f;if(b&&this._isValid()){f=b._view()._getRowInfo(b._rows().item(c));if(f.type&a.wijmo.wijgrid.rowType.data){d=this.column();if(arguments.length===0)return f.data[d.dataKey];else{e=b._parse(d,e);if(e===null&&d.valueRequired||d.dataType&&d.dataType!=="string"&&isNaN(e))throw"invalid value";b._dataStore.updateValue(f.dataItemIndex,d.dataKey,e)}}}};this.toString=function(){return d+":"+c};this._absToData=function(a){d-=a.x;c-=a.y;return this};this._clip=function(e){var b=false,a;if(d<(a=e.topLeft().cellIndex())){b=true;d=a}if(d>(a=e.bottomRight().cellIndex())){b=true;d=a}if(c<(a=e.topLeft().rowIndex())){b=true;c=a}if(c>(a=e.bottomRight().rowIndex())){b=true;c=a}return b};this._clone=function(){return new a.wijmo.wijgrid.cellInfo(d,c)};this._dataToAbs=function(a){d+=a.x;c+=a.y;return this};this._row=function(){return b&&this._isValid()?b._rows().item(c):null};this._isValid=function(){return d>=0&&c>=0};this._isEdit=function(a){if(!arguments.length)return e;e=a};this._setGridView=function(a){b=a}};a.wijmo.wijgrid.cellInfo.prototype.outsideValue=new a.wijmo.wijgrid.cellInfo(-1,-1);a.wijmo.wijgrid.cellInfoRange=function(e,d){if(!e||!d)throw"invalid arguments";var b=e._clone(),c=d._clone();this.bottomRight=function(){return c};this.isEqual=function(a){return a&&b.isEqual(a.topLeft())&&c.isEqual(a.bottomRight())};this.topLeft=function(){return b};this.toString=function(){return b.toString()+" - "+c.toString()};this._isIntersect=function(a){var d,f,e,g;if(a){d=a.bottomRight().rowIndex()-a.topLeft().rowIndex()+1;f=c.rowIndex()-b.rowIndex()+1;if(a.topLeft().rowIndex()+d-b.rowIndex()<d+f){e=a.bottomRight().cellIndex()-a.topLeft().cellIndex()+1;g=c.cellIndex()-b.cellIndex()+1;return a.topLeft().cellIndex()+e-b.cellIndex()<e+g}}return false};this._isValid=function(){return b._isValid()&&c._isValid()};this._clip=function(a){return b._clip(a)|c._clip(a)};this._clone=function(){return new a.wijmo.wijgrid.cellInfoRange(b._clone(),c._clone())};this._containsCellInfo=function(a){return a&&a.cellIndex()>=b.cellIndex()&&a.cellIndex()<=c.cellIndex()&&a.rowIndex()>=b.rowIndex()&&a.rowIndex()<=c.rowIndex()};this._containsCellRange=function(a){return a&&this._containsCellInfo(a.topLeft())&&this._containsCellInfo(a.bottomRight())};this._extend=function(d,a){if(d===1){b.rowIndex(a.topLeft().rowIndex());c.rowIndex(a.bottomRight().rowIndex())}else if(d===2){b.cellIndex(a.topLeft().cellIndex());c.cellIndex(a.bottomRight().cellIndex())}return this};this._normalize=function(){var a=b.cellIndex(),e=b.rowIndex(),d=c.cellIndex(),f=c.rowIndex();b.cellIndex(Math.min(a,d));b.rowIndex(Math.min(e,f));c.cellIndex(Math.max(a,d));c.rowIndex(Math.max(e,f))}}})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{classFactory:function(f,g){var h="#fake#",i=/xyz/.test(function(){xyz})?/\b_base\b/:/.*/,e=f?f.prototype:function(){},c=f?new f(h):new e,a,b,d;for(a in g)if(g.hasOwnProperty(a)){b=g[a];if(e&&typeof b==="function"&&typeof e[a]==="function"&&i.test(b))c[a]=function(b,a){return function(){var d=this._base,c;this._base=e[b];c=a.apply(this,arguments);if(d!==undefined)this._base=d;else delete this._base;return c}}(a,b);else c[a]=b}d=function(a){a!==h&&this.ctor&&this.ctor.apply(this,arguments)};d.prototype=c;d.constructor=c;return d}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.baseView=a.wijmo.wijgrid.classFactory(null,{ctor:function(a){if(!a)throw"'wijgrid' must be specified";this._rowHeaderSize=22;this._wijgrid=a;this._wijgrid.element.addClass("wijmo-wijgrid-table");this._bodyRowsAccessor=null;this._headerRowsAccessor=null;this._rowsAccessor=null},dispose:function(){this.toggleDOMSelection(true);this._wijgrid.element.removeClass("wijmo-wijgrid-table")},ensureDisabledState:function(){var b=this._wijgrid.widgetBaseClass+"-disabled ui-state-disabled",c=this._wijgrid.options.disabled;a.each(this.subTables(),function(f,e){if(e){var d=a(e.element());if(c)d.addClass(b).attr("aria-disabled",true);else d.removeClass(b).attr("aria-disabled",false)}})},ensureWidth:function(a,b){this._setColumnWidth(a,b)},ensureHeight:function(){},getVisibleAreaBounds:function(){throw"not implemented";},getFixedAreaVisibleBounds:function(){throw"not implemented";},render:function(){this._preRender();this._renderContent();this._postRender()},toggleDOMSelection:function(b){a.each(this.subTables(),function(d,c){new a.wijmo.wijgrid.domSelection(c.element()).toggleSelection(b)});new a.wijmo.wijgrid.domSelection(this._wijgrid.outerDiv).toggleSelection(b)},updateSplits:function(){throw"not implemented";},bodyRows:function(){if(!this._bodyRowsAccessor)this._bodyRowsAccessor=new a.wijmo.wijgrid.rowAccessor(this,2,0,0);return this._bodyRowsAccessor},filterRow:function(){if(this._wijgrid.options.showFilter){var b=new a.wijmo.wijgrid.rowAccessor(this,1,0,0);return b.item(b.length()-1)}return null},headerRows:function(){var b;if(!this._headerRowsAccessor){b=this._wijgrid.options.showFilter?1:0;this._headerRowsAccessor=new a.wijmo.wijgrid.rowAccessor(this,1,0,b)}return this._headerRowsAccessor},rows:function(){if(!this._rowsAccessor)this._rowsAccessor=new a.wijmo.wijgrid.rowAccessor(this,0,0,0);return this._rowsAccessor},focusableElement:function(){throw"not implemented";},forEachColumnCell:function(){throw"not implemented";},forEachRowCell:function(){throw"not implemented";},getAbsoluteCellInfo:function(){throw"not implemented";},getAbsoluteRowIndex:function(){throw"not implemented";},getCell:function(){throw"not implemented";},getColumnIndex:function(){throw"not implemented";},getHeaderCell:function(){throw"not implemented";},getJoinedCols:function(){throw"not implemented";},getJoinedRows:function(){throw"not implemented";},getJoinedTables:function(){throw"not implemented";},subTables:function(){throw"not implemented";},_getMappedScrollMode:function(){var c=this._wijgrid.options.scrollMode,b="auto",a="auto";switch(c){case"horizontal":b="hidden";a="visible";break;case"vertical":b="visible";a="hidden";break;case"both":b="visible";a="visible"}return{vScrollBarVisibility:b,hScrollBarVisibility:a}},_postRender:function(){this.ensureDisabledState()},_preRender:function(){throw"not implemented";},_renderContent:function(){this._renderCOLS();this._renderHeader();this._wijgrid.options.showFilter&&this._renderFilter();this._renderBody();this._wijgrid.options.showFooter&&this._renderFooter()},_renderCOLS:function(){var c=this._wijgrid._field("visibleLeaves"),b,d,a,e;for(a=0,e=c.length;a<e;a++){b=c[a];d=this._createCol(b,a);this._appendCol(d,b,a)}},_renderHeader:function(){var f=a.wijmo.wijgrid.rowType,c=this._wijgrid._field("columnHeadersTable"),b,e,d;if(c&&(e=c.length))for(b=0;b<e;b++){d=this._insertEmptyRow(f.header,b,-1,-1,-1);this._renderRow(d,null,c[b])}},_renderFilter:function(){var b=this._insertEmptyRow(a.wijmo.wijgrid.rowType.filter,-1,-1,-1,-1);this._renderRow(b,this._wijgrid._field("visibleLeaves"),null)},_renderBody:function(){var k=a.wijmo.wijgrid.rowType,i=this._wijgrid._field("visibleLeaves"),g=this._wijgrid.sketchTable,j=-1,e=0,c,h,f,b,d;if(this._wijgrid._dataStore.dataMode()===a.wijmo.wijgrid.dataMode.dynamical)e=this._wijgrid.options.pageIndex*this._wijgrid.options.pageSize;for(c=0,h=g.length;c<h;c++){b=g[c];d=(b.rowType&k.data)!==0;f=this._insertEmptyRow(b.rowType,c,d?++j:-1,d?b.originalRowIndex:-1,d?e+b.originalRowIndex:-1);this._renderRow(f,i,b)}},_renderFooter:function(){var b=this._insertEmptyRow(a.wijmo.wijgrid.rowType.footer,-1,-1,-1,-1);this._renderRow(b,this._wijgrid._field("visibleLeaves"),null)},_insertEmptyRow:function(c,b,f,e,d){var h=this._wijgrid._onViewInsertEmptyRow.apply(this._wijgrid,arguments),g=this._insertRow(c,b,h);return this._createRowInfo(g,c,a.wijmo.wijgrid.renderState.rendering,b,f,e,d)},_createEmptyCell:function(c){var f=a.wijmo.wijgrid.rowType,b=this._wijgrid._onViewCreateEmptyCell.apply(this._wijgrid,arguments);return this._createCell(c.type,b)},_insertRow:function(){throw"not implemented";},_createCell:function(c,b){var d=a.wijmo.wijgrid.rowType;if(!b)b=c===d.header?"<th />":"<td />";return c!==d.filter?a(b).wrapInner('<div class="wijmo-wijgrid-innercell"></div>'):a(b)},_appendCell:function(){throw"not implemented";},_createCol:function(){throw"not implemented";},_appendCol:function(){throw"not implemented";},_renderRow:function(c,e,d){var b=a.wijmo.wijgrid.rowType,g,f;switch(c.type){case b.filter:this._renderFilterRow(c,e);break;case b.footer:this._renderFooterRow(c,e);break;case b.header:this._renderHeaderRow(c,d);break;case b.data:case b.data|b.dataAlt:this._renderDataRow(c,e,d);g=d.__attr;f=d.__style;break;case b.emptyDataRow:case b.groupHeader:case b.groupFooter:this._renderSpannedRow(c,e,d);g=d.__attr;f=d.__style;break;default:throw"unknown rowType";}this._rowRendered(c,g,f)},_renderCell:function(b,f,g,h,d,j,i){var c=this._createEmptyCell(b,d.dataIndex,d),e=b.type===a.wijmo.wijgrid.rowType.filter?c:c.children("div");this._appendCell(b,f,c);if(h)e.html(g);else this._wijgrid.cellFormatter.format(e,d,g,b);this._cellRendered(b,c,f,d,j,i)},_renderDataRow:function(k,f,b){var d,j,c,a,e,h,g,i=false;for(d=0,j=f.length;d<j;d++){c=f[d];a=c.dataIndex;e=null;if(a>=0&&(!b[a]||b[a].visible===false))continue;if(c.dataParser)e=a>=0?this._wijgrid._toStr(c,b[a].value):null;else if(a>=0){e=b[a].html;i=true}h=a>=0?b[a].__attr:null;g=a>=0?b[a].__style:null;this._renderCell(k,d,e,i,c,h,g)}},_renderFilterRow:function(f,d){var b,e,c;for(b=0,e=d.length;b<e;b++){c=d[b];this._renderCell(f,b,a.wijmo.wijgrid.filterHelper.getSingleValue(c.filterValue),false,c)}},_renderFooterRow:function(d,b){var a,c;for(a=0,c=b.length;a<c;a++)this._renderCell(d,a,"",false,b[a])},_renderHeaderRow:function(c,d){var b,e,f=0,a;for(b=0,e=d.length;b<e;b++){a=d[b];if(a.column&&a.column.parentVis){a.column.thX=f++;a.column.thY=c.sectionRowIndex;this._renderCell(c,b,a.column.headerText,false,a.column,{colSpan:a.colSpan,rowSpan:a.rowSpan})}}},_renderSpannedRow:function(d,c,b){for(var f,e=Math.min(c.length,b.length),a=0;a<e;a++)this._renderCell(d,a,b[a].html,true,c[a],b[a].__attr,b[a].__style)},_cellRendered:function(d,b,c,e,g,f){this._wijgrid.cellStyleFormatter.format(b,c,e,d,a.wijmo.wijgrid.renderState.rendering,g,f);this._changeCellRenderState(b,a.wijmo.wijgrid.renderState.rendering,false);this._wijgrid._onViewCellRendered(d,b,c,e)},_rowRendered:function(b,d,c){this._wijgrid.rowStyleFormatter.format(b,d,c);b.state&=~a.wijmo.wijgrid.renderState.rendering;this._setRowInfo(b.$rows,b);this._wijgrid._onViewRowRendered(b)},_isBodyRow:function(){var b=a.wijmo.wijgrid.rowType,c=b.type;return c&b.data||c===b.groupHeader||c===b.groupFooter||c===b.emptyDataRow},_changeRowRenderState:function(a,b,c){if(c)a.state|=b;else a.state&=~b;this._setRowInfo(a.$rows,a)},_changeCellRenderState:function(d,b,g){var e=a.wijmo.wijgrid.dataPrefix,c=this._wijgrid._data$prefix,f=e(d,c,"renderState");if(g){b=f|b;e(d,c,"renderState",b)}else{b=f&~b;e(d,c,"renderState",b)}return b},_adjustWidthArray:function(j,k,d,n,c){var h=this._sumWidthArray(j),l=this._sumWidthArray(k),b=[],e,f=0,g,i,m=true;if(h<=d){a.extend(true,b,j);if(h===d||n)return b;else e=d-h}else{a.extend(true,b,k);if(l>=d)return b;else e=d-l}a.each(b,function(b,a){if(!a.real)f++});if(f!==0){if(c!==undefined&&c>-1&&c<b.length&&!b[c].real){b[c].width+=e;return b}g=Math.floor(e/f);i=e-g*f;a.each(b,function(b,a){if(!a.real){a.width+=g;if(m){a.width+=i;m=false}}})}return b},_getColumnWidth:function(m,k){var e,c,f,j,l,i,d,g,n,h,b,o;if(k){e=this._wijgrid._field("visibleLeaves")[m];if(e._realWidth!==undefined)c={width:e._realWidth,real:true};else if(e.isRowHeader)c={width:this._rowHeaderSize,real:true};else{f=0;j=this.getJoinedTables(true,m);l=j[2];for(i=0;i<2;i++){d=j[i];if(d!==null){g=d.element().rows;if(o=g.length){for(b=o-1,h=null;b>=0;b--)if(g[b].cells.length===d.width()){h=g[b];break}if(h){n=h.cells[l];f=Math.max(f,a(n).outerWidth())}}}}c={width:f,real:false}}k.push(c)}},_setColumnWidth:function(c,b){var e=this.getHeaderCell(c),d=this.getJoinedCols(c);if(b){a(e).setOutWidth(b);a.each(d,function(d,c){a(c).setOutWidth(b)})}},_setTableWidth:function(d,c,f,g){var e,b;a.each(d,function(b,a){a.css("table-layout","fixed").setOutWidth(c)});e=d[0].outerWidth();b=e-c;b!==0&&this._setColumnWidth(g,f-b)},_sumWidthArray:function(e,b,c){var d=0;a.each(e,function(a,e){if(b!==undefined&&c!==undefined&&(a<b||a>c))return true;d+=e.width});return d},_setRowInfo:function(g,b){var d="$rows"in b,c="data"in b,f,e;if(d){f=b.$rows;delete b.$rows}if(c){e=b.data;delete b.data}a.wijmo.wijgrid.dataPrefix(g,this._wijgrid._data$prefix,"rowInfo",b);if(d)b.$rows=f;if(c)b.data=e},_getRowInfo:function(c){var d=this._wijgrid,e=c[1]?a(c):a(c[0]),b=a.wijmo.wijgrid.dataPrefix(e,d._data$prefix,"rowInfo"),f;b.$rows=e;if(b.dataItemIndex>=0&&b.type&a.wijmo.wijgrid.rowType.data)b.data=d._getDataItem(b.dataItemIndex);return b},_createRowInfo:function(i,d,h,f,g,b,e){var j,c={type:d,state:h,sectionRowIndex:f,dataRowIndex:g,dataItemIndex:b,virtualDataItemIndex:e,$rows:a(i)};if(b>=0&&d&a.wijmo.wijgrid.rowType.data)c.data=this._wijgrid._getDataItem(b);return c}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.flatView=a.wijmo.wijgrid.classFactory(a.wijmo.wijgrid.baseView,{ctor:function(a){this._base(a);this._dataTable=null;this._contentArea=null},ensureWidth:function(e,b,c){var d=a(this._dataTable.element()),f=d.width()+b-c;this._base(e,b,c);this._setTableWidth([d],f,b,e)},getVisibleAreaBounds:function(){var b=a.wijmo.wijgrid.bounds(this._dataTable.element()),c;if(this._wijgrid.options.scrollMode==="none")return b;else{c=a.wijmo.wijgrid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijgrid-split-area-se:first")[0]);return{top:b.top,left:b.left,width:Math.min(c.width,b.width),height:Math.min(c.height,b.height)}}},updateSplits:function(){var f=this,e=this._wijgrid,h=e.options,g=e.element,i=[],j=[],b=[],d=e._field("visibleLeaves"),l=e.outerDiv,k,c;g.css({"table-layout":"",width:""});a.each(d,function(d,b){var c,a=b.width;if(a||a===0){c=typeof a==="string"&&a.length>1&&a[a.length-1]==="%";if(c)a=l.width()*parseFloat(a)/100;else a=parseFloat(a);if(b.ensurePxWidth||b.ensurePxWidth===undefined&&h.ensureColumnsPxWidth)b._realWidth=a;f._setColumnWidth(d,a)}});a.each(d,function(a){f._getColumnWidth(a,i)});g.css("width","1px");a.each(d,function(a){f._getColumnWidth(a,j)});k=l.innerWidth();b=this._adjustWidthArray(i,j,k,h.ensureColumnsPxWidth,h.autoExpandColumnIndex);a.each(b,function(a,c){var b=d[a];if(b._realWidth!==undefined){delete b._realWidth;return}f._setColumnWidth(a,c.width)});c=b.length-1;c!==-1&&this._setTableWidth([g],this._sumWidthArray(b,0,c),b[c].width,c)},focusableElement:function(){return a(this._dataTable.element())},forEachColumnCell:function(a,b,c){return this._dataTable.forEachColumnCell(a,b,c)},forEachRowCell:function(b,a,c){return this._dataTable.forEachRowCell(b,a,c)},getAbsoluteCellInfo:function(b){return new a.wijmo.wijgrid.cellInfo(this.getColumnIndex(b),b.parentNode.rowIndex)},getAbsoluteRowIndex:function(a){return a.rowIndex},getCell:function(d,b){var c=this._dataTable.getCellIdx(d,b),a;if(c>=0){a=this.getJoinedRows(b,0);if(a[0])return a[0].cells[c]}return null},getColumnIndex:function(a){return this._dataTable.getColumnIdx(a)},getHeaderCell:function(d){var b=this._wijgrid._field("visibleLeaves")[d],c;return b&&(c=this._wijgrid._headerRows())?(new a.wijmo.wijgrid.rowAccessor).getCell(c.item(b.thY),b.thX):null},getJoinedCols:function(c){var b=a(this._dataTable.element()).find("> colgroup");if(b.length)if(c<b[0].childNodes.length)return[b[0].childNodes[c],null];return[null,null]},getJoinedRows:function(a,b){return[this._dataTable.getSectionRow(a,b),null]},getJoinedTables:function(b,a){return[this._dataTable,null,a]},subTables:function(){return[this._dataTable]},_preRender:function(){this._dataTable=new a.wijmo.wijgrid.htmlTableAccessor(this._wijgrid.element[0],true,true,true)},_postRender:function(){this._wijgrid.element.find("> tbody").addClass("ui-widget-content wijmo-wijgrid-data");this._dataTable=new a.wijmo.wijgrid.htmlTableAccessor(this._wijgrid.element[0]);this._wijgrid.element.attr({role:"grid",cellpadding:"0",border:"0",cellspacing:"0"}).css("border-collapse","separate");this._base()},_insertRow:function(f,c,e){var d=a.wijmo.wijgrid.rowType,b;switch(f){case d.header:case d.filter:b=this._dataTable.ensureTHead();break;case d.footer:b=this._dataTable.ensureTFoot();break;default:b=this._dataTable.ensureTBody()}if(e)return[b.appendChild(e)];else{if(c>b.rows.length)c=-1;return[b.insertRow(c)]}},_rowRendered:function(a,d,c){var b=a.$rows[0];if(!b.cells.length&&this._isBodyRow(a))b.parentNode.removeChild(b);else this._base(a,d,c)},_appendCell:function(a,c,b){a.$rows.append(b)},_createCol:function(){return document.createElement("col")},_appendCol:function(a){this._dataTable.appendCol(a)}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.fixedView=a.wijmo.wijgrid.classFactory(a.wijmo.wijgrid.baseView,{ctor:function(b){this._base(b);this._verScrollBarSize=18;this._mouseWheelHandler=a.proxy(this._onMouseWheel,this);this._rowsCount=null;this._viewTables={};this._splitAreas={};this._scroller=null;this.element=b.element;this._staticDataRowIndex=b._getStaticIndex(true);this._staticRowIndex=b._getRealStaticRowIndex();this._staticColumnIndex=b._getRealStaticColumnIndex();this._staticAllColumnIndex=this._staticColumnIndex===-1?-1:b._field("visibleLeaves")[this._staticColumnIndex].leavesIdx},dispose:function(){this._base();this._wijgrid.outerDiv.unbind("mousewheel",this._mouseWheelHandler)},ensureWidth:function(f,g,p){var j=this._wijgrid,d=j.options,h=this._staticColumnIndex,k=f<=h,b=a(this._viewTables.nw.element()),e=a(this._viewTables.ne.element()),i=a(this._viewTables.sw.element()),c=a(this._viewTables.se.element()),m=k?[b,i]:[e,c],n=(k?b.width():e.width())+g-p,o=j._field("frozener"),l=this.getScrollValue();this._scroller.data("wijsuperpanel")&&this._scroller.wijsuperpanel("destroy");this._base(f,g);this._setTableWidth(m,n,g,f);try{if(h>=0)d.splitDistanceX=b[0].offsetWidth;else d.splitDistanceX=0}catch(q){}this._updateSplitAreaBounds(0);c.css("height","");this._adjustRowHeight();c.height(Math.max(c.height(),i.height()));try{if(this._staticRowIndex>=0)d.splitDistanceY=Math.max(b[0].offsetHeight,e[0].offsetHeight);else d.splitDistanceY=0}catch(q){}this._updateSplitAreaBounds(1);this.refreshPanel(l);o.refresh()},ensureHeight:function(k){var b,d=this._wijgrid,e=d.options,h=a(this._viewTables.nw.element()),g=a(this._viewTables.ne.element()),i=a(this._viewTables.sw.element()),c=a(this._viewTables.se.element()),j=d._field("frozener"),f=this.getScrollValue();this._scroller.data("wijsuperpanel")&&this._scroller.wijsuperpanel("destroy");if(arguments.length>0){b=this.getJoinedRows(k,2);this._setRowHeight(b,this._getRowHeight(b))}c.css("height","");c.height(Math.max(c.height(),i.height()));try{if(this._staticRowIndex>=0)e.splitDistanceY=Math.max(h[0].offsetHeight,g[0].offsetHeight);else e.splitDistanceY=0}catch(l){}this._updateSplitAreaBounds(1);this.refreshPanel(f);j.refresh()},getScrollValue:function(){var a=this._getSuperPanel();return a?{type:"fixed",hScrollValue:a.options.hScroller.scrollValue,vScrollValue:a.options.vScroller.scrollValue}:{type:"fixed",hScrollValue:null,vScrollValue:null}},getVisibleAreaBounds:function(){var b=a.wijmo.wijgrid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-contentwrapper:first"));if(!b)b=a.wijmo.wijgrid.bounds(this._wijgrid.outerDiv);return b},getFixedAreaVisibleBounds:function(){var b=this.getVisibleAreaBounds(),f=a.wijmo.wijgrid.bounds(this._splitAreas.ne),c=a.wijmo.wijgrid.bounds(this._splitAreas.nw),d=null,e=null;if(f.height||c.height)d={left:b.left,top:b.top,width:b.width,height:Math.min(f.height||c.height,b.height)};if(c.width)e={left:b.left,top:b.top,width:Math.min(c.width,b.width),height:b.height};return[d,e]},refreshPanel:function(d){var e=this,b=this._wijgrid,c=b.options,g=this._getGridWidth(c.scrollMode),f=this._getMappedScrollMode(),h=this._testNeedVBar(b.outerDiv,b.element,a(this._viewTables.ne.element()),c.scrollMode,b._autoHeight);this._scroller.width(g);this._splitAreas.ne.width(g-c.splitDistanceX-(h?this._verScrollBarSize:0));if(!this._scroller.data("wijsuperpanel"))this._scroller.wijsuperpanel({disabled:b.options.disabled,scroll:a.proxy(this._onScroll,this),bubbleScrollingEvent:true,vScroller:{scrollBarVisibility:f.vScrollBarVisibility,scrollValue:d.type==="fixed"?d.vScrollValue:null},hScroller:{scrollBarVisibility:f.hScrollBarVisibility,scrollValue:d.type==="fixed"?d.hScrollValue:null},hScrollerActivating:function(f,d){var a;if(b._autoHeight){a=b.element.height()+c.splitDistanceY-d.contentLength;if(a>0){e._scroller.height(e._scroller.height()+a);e._scroller.wijsuperpanel("paintPanel");return false}}e._splitAreas.sw.height(d.contentLength-c.splitDistanceY)}});else this._scroller.wijsuperpanel("paintPanel");this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer, .wijmo-wijsuperpanel-vbarcontainer").css("zIndex",5)},scrollTo:function(n){if(!n.tableCell())return;var u=this._wijgrid,v=u.options,m=this._getSuperPanel(),t=n.tableCell(),o=t.nodeType?a(t):t,l,s,d,f,k,i,r,b,c,j,h,e=null,g=null,x,p,w,q;if(m&&o.is(":visible")){l=m.getContentElement();s=l.parent();d=parseInt((l.css("left")+"").replace("px",""),10)*-1;f=parseInt((l.css("top")+"").replace("px",""),10)*-1;k=s.outerWidth()-v.splitDistanceX;i=s.outerHeight()-v.splitDistanceY;r=o.position();b=r.left;c=r.top;j=o.outerWidth();h=o.outerHeight();x=u._getStaticIndex(true);p=u._getStaticIndex(false);w=n.rowIndex();q=n.cellIndex();if(w<=x)if(q<=p){e=0;g=0}else{b+=d;if(b+j>d+k)d=e=b+j-k;if(b<d)e=b;g=0}else if(q<=p){c+=f;if(c+h>f+i)f=g=c+h-i;if(c<f)g=c;e=0}else{b-=v.splitDistanceX;if(c+h>f+i)f=g=c+h-i;if(b+j>d+k)d=e=b+j-k;if(c<f)g=c;if(b<d)e=b}e!==null&&m.hScrollTo(e);g!==null&&m.vScrollTo(g)}},updateSplits:function(s){var k=this._wijgrid,c=k.options,r,o,i,l=this,d=[],q=[],p=[],g=this._staticColumnIndex,b,t=c.scrollMode,m=k._field("visibleLeaves"),e=a(this._viewTables.se.element()),f=a(this._viewTables.ne.element()),j=a(this._viewTables.sw.element()),h=a(this._viewTables.nw.element()),n=k.outerDiv;this._scroller.data("wijsuperpanel")&&this._scroller.wijsuperpanel("destroy");n.unbind("mousewheel",this._mouseWheelHandler);r=e.find("tbody .wijmo-wijgrid-row:not(.wijmo-wijgrid-groupheaderrow):first");this.fooRow=o=r.clone().removeAttr("datarowindex").addClass("wijmo-wijgrid-foorow").appendTo(r.parent()).show().height(0).css({"font-size":"0"});this._setRowInfo(this.fooRow,this._createRowInfo(this.fooRow,a.wijmo.wijgrid.rowType.fooRow,-1,-1,-1,-1,-1));this.fooRowCells=o.find(">td").height(0).css({"border-top":"0","border-bottom":"0"}).find(">div.wijmo-wijgrid-innercell").css({"padding-top":"0px","padding-bottom":"0px"}).empty();o.css("visibility","hidden");o.length===0&&k.element.css("width","100%");a.each([e,f,j,h],function(b,a){a.css({"table-layout":"",width:""})});a.each(m,function(e,b){var d,a=b.width;if(a||a===0){d=typeof a==="string"&&a.length>1&&a[a.length-1]==="%";if(d)a=n.width()*parseFloat(a)/100;else a=parseFloat(a);if(b.ensurePxWidth||b.ensurePxWidth===undefined&&c.ensureColumnsPxWidth)b._realWidth=a;l._setColumnWidth(e,a)}});a.each(m,function(a){l._getColumnWidth(a,p)});a.each([h,f,j,e],function(b,a){a.css({width:"1px"})});a.each(m,function(a){l._getColumnWidth(a,q)});i=n.innerWidth();d=this._adjustWidthArray(p,q,i,c.ensureColumnsPxWidth,c.autoExpandColumnIndex);a.each(d,function(a,c){var b=m[a];if(b._realWidth!==undefined){delete b._realWidth;return}l._setColumnWidth(a,c.width)});if(g>=0){b=g;this._setTableWidth([h,j],this._sumWidthArray(d,0,b),d[b].width,b)}try{if(g>=0)c.splitDistanceX=h[0].offsetWidth;else c.splitDistanceX=0}catch(u){}this._updateSplitAreaBounds(0);!c.ensureColumnsPxWidth&&f.parent().width(i-c.splitDistanceX);b=d.length-1;b!==-1&&this._setTableWidth([f,e],this._sumWidthArray(d,g+1,b),d[b].width,b);e.css("height","");this._adjustRowHeight();e.height(Math.max(e.height(),j.height()));try{if(this._staticRowIndex>=0)c.splitDistanceY=Math.max(h[0].offsetHeight,f[0].offsetHeight);else c.splitDistanceY=0}catch(u){}this._updateSplitAreaBounds(1);if(!c.ensureColumnsPxWidth)if(this._testNeedVBar(k.outerDiv,e,f,t,k._autoHeight)){i-=this._verScrollBarSize;d=this._adjustWidthArray(p,q,i,c.ensureColumnsPxWidth,c.autoExpandColumnIndex);a.each(d,function(b,a){!a.real&&l._setColumnWidth(b,a.width)});if(g>=0){b=g;this._setTableWidth([h,j],this._sumWidthArray(d,0,b),d[b].width,b)}try{if(g>=0)c.splitDistanceX=h[0].offsetWidth;else c.splitDistanceX=0}catch(u){}this._updateSplitAreaBounds(0);f.parent().width(i-c.splitDistanceX);b=d.length-1;b!==-1&&this._setTableWidth([f,e],this._sumWidthArray(d,g+1,b),d[b].width,b);e.css("height","");this._adjustRowHeight();e.height(Math.max(e.height(),j.height()));try{if(this._staticRowIndex>=0)c.splitDistanceY=Math.max(h[0].offsetHeight,f[0].offsetHeight);else c.splitDistanceY=0}catch(u){}this._updateSplitAreaBounds(1)}this.refreshPanel(s);n.bind("mousewheel",this._mouseWheelHandler)},bodyRows:function(){var a=this._base();a&&this.fooRow&&a._offsetBottom(1);return a},focusableElement:function(){return this._wijgrid.outerDiv},forEachColumnCell:function(f,d,e){var b=this.getJoinedTables(true,f),c,a;if(b[0]!==null){c=b[2];a=b[0].forEachColumnCell(c,d,e);if(a!==true)return a;if(b[1]!==null){a=b[1].forEachColumnCell(c,d,e);if(a!==true)return a}}return true},forEachRowCell:function(h,f,g){var c=this.getJoinedTables(false,h),d=c[0],e=c[1],b,a;if(d!==null){b=c[2];if(b<d.element().rows.length){a=d.forEachRowCell(b,f,g);if(a!==true)return a}if(e!==null&&b<e.element().rows.length){a=e.forEachRowCell(b,f,g);if(a!==true)return a}}return true},getAbsoluteCellInfo:function(b){return new a.wijmo.wijgrid.cellInfo(this.getColumnIndex(b),this.getAbsoluteRowIndex(b.parentNode))},getAbsoluteRowIndex:function(b){var c=b.rowIndex,a=b.parentNode;while(a.tagName.toLowerCase()!=="table")a=a.parentNode;return a===this._viewTables.nw.element()||a===this._viewTables.ne.element()?c:c+this._staticRowIndex+1},getCell:function(g,h){var a=this.getJoinedTables(false,h),c,e,d,b,f;if(a[0]!==null){c=this.getJoinedTables(true,g);if(c[0]!==null){e=a[2];d=c[2];b=null;if(a[1]!==null)b=g===d?a[0]:a[1];else b=a[0];f=b.getCellIdx(d,e);if(f>=0)return b.element().rows[e].cells[f]}}return null},getColumnIndex:function(e){for(var a=null,b=null,d=false,c,a=e.parentNode;a.tagName.toLowerCase()!=="table";a=a.parentNode);if(a!==null){if(a===this._viewTables.nw.element())b=this._viewTables.nw;else if(a===this._viewTables.ne.element()){b=this._viewTables.ne;d=true}else if(a===this._viewTables.sw.element())b=this._viewTables.sw;else if(a===this._viewTables.se.element()){b=this._viewTables.se;d=true}if(b!==null){c=b.getColumnIdx(e);if(d)c+=this._staticColumnIndex+1;return c}}return-1},getHeaderCell:function(d){var b=this._wijgrid._field("visibleLeaves")[d],c;return b&&(c=this._wijgrid._headerRows())?(new a.wijmo.wijgrid.rowAccessor).getCell(c.item(b.thY),b.thX):null},getJoinedCols:function(d){var c=[],b=this.getJoinedTables(true,d),e=b[2];b.splice(b.length-1,1);a.each(b,function(d,b){c.push(b?a(b.element()).find("col")[e]:null)});return c},getJoinedRows:function(c,e){var f=null,g=null,a=null,d=null,l=this._staticRowIndex,b=this._staticColumnIndex,m=this._wijgrid._field("visibleLeaves").length-1,n=this._rowsCount-1,k=l===n,h=l<0,j=!k&&!h,i=0;if(k||j){if(b>=0&&b<m){a=this._viewTables.nw;d=this._viewTables.ne}else a=b<0?this._viewTables.ne:this._viewTables.nw;i=a.getSectionLength(e);if(c<i){f=a.getSectionRow(c,e);if(d!==null)g=d.getSectionRow(c,e)}}if(h||j&&f===null){if(!h)c-=i;if(b>=0&&b<m){a=this._viewTables.sw;d=this._viewTables.se}else a=b<0?this._viewTables.se:this._viewTables.sw;f=a.getSectionRow(c,e);if(d!==null)g=d.getSectionRow(c,e)}return f===null&&g===null?null:[f,g]},getJoinedTables:function(g,f){var a=null,b=null,c=f,h=this._wijgrid,e=this._staticRowIndex,d=this._staticColumnIndex;if(g){if(f<=d){a=this._viewTables.nw;b=this._viewTables.sw}else{a=this._viewTables.ne;b=this._viewTables.se;c=c-(d+1)}if(e<0)a=null;if(e===this._rowsCount-1)b=null}else{if(f<=e){a=this._viewTables.nw;b=this._viewTables.ne}else{a=this._viewTables.sw;b=this._viewTables.se;c=c-(e+1)}if(d<0)a=null;if(d===h._field("leaves").length-1)b=null}if(a===null){a=b;b=null}return[a,b,c]},subTables:function(){return[this._viewTables.nw,this._viewTables.ne,this._viewTables.sw,this._viewTables.se]},_getGridWidth:function(e){var b=this._wijgrid,c=b.element.outerWidth(true)+b.options.splitDistanceX,d=b.outerDiv.innerWidth();if(this._testNeedVBar(b.outerDiv,b.element,a(this._viewTables.ne.element()),e,b._autoHeight))c+=this._verScrollBarSize;if(c>d)c=d;return c},_getSuperPanel:function(){return this._scroller?this._scroller.data("wijsuperpanel"):null},_preRender:function(){var b=document.createDocumentFragment(),c=a.wijmo.wijgrid.htmlTableAccessor;this._wijgrid.outerDiv.wrapInner('<div class="wijmo-wijgrid-fixedview"><div class="wijmo-wijgrid-scroller"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>');this._scroller=this._wijgrid.outerDiv.find(".wijmo-wijgrid-scroller");this._scroller.after(this._splitAreas.nw=a('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>'));this._scroller.after(this._splitAreas.ne=a('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>'));this._scroller.after(this._splitAreas.sw=a('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>'));this._splitAreas.se=this._scroller.find(".wijmo-wijgrid-split-area-se:first");this._viewTables={nw:new c(b.appendChild(document.createElement("table")),true,true,true),ne:new c(b.appendChild(document.createElement("table")),true,true,true),sw:new c(b.appendChild(document.createElement("table")),true,true,true),se:new c(b.appendChild(this._wijgrid.element[0]),true,true,true)}},_postRender:function(){var c,d,e,f,b=a.wijmo.wijgrid.htmlTableAccessor;this._viewTables={nw:new b(c=this._viewTables.nw.element()),ne:new b(d=this._viewTables.ne.element()),sw:new b(e=this._viewTables.sw.element()),se:new b(f=this._viewTables.se.element())};this._splitAreas.nw.empty().append(c);this._splitAreas.ne.empty().append(d);this._splitAreas.sw.empty().append(e);this._splitAreas.se.empty().append(f);a.each(this._viewTables,function(c,b){a(b.element()).addClass("wijmo-wijgrid-table").attr({role:"grid",border:"0",cellpadding:"0",cellspacing:"0"}).css("border-collapse","separate").find("> tbody").addClass("ui-widget-content wijmo-wijgrid-data")});this._rowsCount=Math.max(c.rows.length,d.rows.length)+Math.max(e.rows.length,f.rows.length);this._base()},_createCol:function(){return[document.createElement("col"),document.createElement("col")]},_appendCol:function(a,c,b){if(b<=this._staticColumnIndex){this._viewTables.nw.appendCol(a[0]);this._viewTables.sw.appendCol(a[1])}else{this._viewTables.ne.appendCol(a[0]);this._viewTables.se.appendCol(a[1])}},_insertRow:function(h,e,f){var g=a.wijmo.wijgrid.rowType,d,c,b=this._viewTables;switch(h){case g.header:case g.filter:d=b.nw.ensureTHead();c=b.ne.ensureTHead();break;case g.footer:d=b.sw.ensureTFoot();c=b.se.ensureTFoot();break;default:if(e<=this._staticDataRowIndex){d=b.nw.ensureTBody();c=b.ne.ensureTBody()}else{d=b.sw.ensureTBody();c=b.se.ensureTBody()}}return f?[d.appendChild(f),c.appendChild(f.cloneNode(false))]:[d.insertRow(e>d.rows.length?-1:e),c.insertRow(e>c.rows.length?-1:e)]},_rowRendered:function(c,e,d){var b=c.$rows[0],a=c.$rows[1];if(!b.cells.length&&this._isBodyRow(c)){b.parentNode.removeChild(b);b=null}if(!a.cells.length&&this._isBodyRow(c)){a.parentNode.removeChild(a);a=null}(b||a)&&this._base(c,e,d)},_appendCell:function(b,e,c){var d=b.type!==a.wijmo.wijgrid.rowType.header?this._staticColumnIndex:this._staticAllColumnIndex;if(e<=d)b.$rows[0].appendChild(c[0]);else b.$rows[1].appendChild(c[0])},_getRowHeight:function(b){if(b[0]&&b[1]){var e=[a(b[0]),a(b[1])],c,d;a.each(e,function(b,a){a.css("height","")});c=e[0].height();d=e[1].height();if(c>d)return c;else if(c<d)return d}return null},_setRowHeight:function(c,b){if(c[0]&&c[1]){var e=[a(c[0]),a(c[1])],d;if(b===null)return;b+=1;a.each(e,function(c,a){a.height(b);d=b-a.height();d&&a.height(b+d)})}},_adjustRowHeight:function(){var t=this._wijgrid,r=this._staticColumnIndex,s=t._field("visibleLeaves").length-1,b,d,k,g,m,h,n,i,o,j,p,f,a,q,c,e,l=[];if(r>-1&&r<s){b=this._staticRowIndex;d=this._rowsCount-1;k=this._viewTables;if(b>-1&&b<=d){g=k.ne.element();m=g.parentNode;h=k.nw.element();n=h.parentNode;c=h.rows;e=g.rows;f=c.length;for(a=0;a<f;a++)l.push(this._getRowHeight([c[a],e[a]]))}if(b>=-1&&b<d){i=k.se.element();o=i.parentNode;j=k.sw.element();p=j.parentNode;c=j.rows;e=i.rows;f=c.length;for(a=0;a<f;a++)l.push(this._getRowHeight([c[a],e[a]]))}if(b>-1&&b<=d){n.removeChild(h);m.removeChild(g)}if(b>=-1&&b<d){p.removeChild(j);o.removeChild(i)}if(b>-1&&b<=d){c=h.rows;e=g.rows;f=c.length;for(a=0,q=0;a<f;a++)this._setRowHeight([c[a],e[a]],l[q++])}if(b>=-1&&b<d){c=j.rows;e=i.rows;f=c.length;for(a=0;a<f;a++)this._setRowHeight([c[a],e[a]],l[q++])}if(b>-1&&b<=d){n.appendChild(h);m.appendChild(g)}if(b>=-1&&b<d){p.appendChild(j);o.appendChild(i)}}},_onScroll:function(e,a){var b,c,d={};if(a.dir==="h"){b=this._splitAreas.ne;c="scrollLeft"}else{b=this._splitAreas.sw;c="scrollTop"}if(a.animationOptions){d[c]=a.position;b.animate(d,a.animationOptions)}else b[0][c]=a.position},_onScrolled:function(){this._splitAreas.ne[0].scrollLeft=parseInt((this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-templateouterwrapper:first").css("left")+"").replace("px",""),10)*-1;this._splitAreas.sw[0].scrollTop=parseInt((this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-templateouterwrapper:first").css("top")+"").replace("px",""),10)*-1},_onMouseWheel:function(b,f){var d,g=f>0?"top":"bottom",c=false,e;if(this._wijgrid._canInteract()){d=this.getFixedAreaVisibleBounds();a.each(d,function(e,d){if(d&&a.ui.isOver(b.pageY,b.pageX,d.top,d.left,d.height,d.width)){c=true;return false}});if(c&&this._scroller.data("wijsuperpanel")){e=this._scroller.wijsuperpanel("option","vScroller").scrollValue;this._scroller.wijsuperpanel("doScrolling",g);if(e!==this._scroller.wijsuperpanel("option","vScroller").scrollValue){b.stopPropagation();b.preventDefault()}}}},_testNeedVBar:function(h,i,n,d,k){var b,a=this._wijgrid,m=n.width()+a.options.splitDistanceX,f=i.height()+a.options.splitDistanceY,l=h.width(),j=h.height(),c,g=0,e=0;if(a.$superPanelHeader!==null)g=a.$superPanelHeader.outerHeight(true);if(a.$bottomPagerDiv!==null)e=a.$bottomPagerDiv.outerHeight(true);c=j-g-e;if(d==="both"||d==="vertical")b=true;else b=d==="auto"&&(f>c||!k&&m>l&&f>c-this._verScrollBarSize);return b},_updateSplitAreaBounds:function(e){var b=this._wijgrid,a=b.options,d,f,c=0,g=0;if(e===0||e===2){this._splitAreas.nw.width(a.splitDistanceX);this._splitAreas.sw.width(a.splitDistanceX);this._splitAreas.se.css("marginLeft",a.splitDistanceX);this._splitAreas.ne.css("marginLeft",a.splitDistanceX)}if(e===1||e===2){this._scroller.css("height","");this._splitAreas.se.css("marginTop",0);d=b.outerDiv.height();if(!b._autoHeight)this._scroller.height(d);else this._scroller.height(d+a.splitDistanceY);this._splitAreas.nw.height(a.splitDistanceY);this._splitAreas.ne.height(a.splitDistanceY);if(b.$superPanelHeader!==null)c=b.$superPanelHeader.outerHeight(true);if(b.$bottomPagerDiv!==null)g=b.$bottomPagerDiv.outerHeight(true);f=d-c-g;if(b.$superPanelHeader!==null){this._splitAreas.nw.css("top",c+"px");this._splitAreas.ne.css("top",c+"px")}if(!b._autoHeight)this._splitAreas.sw.height(f-a.splitDistanceY);else this._splitAreas.sw.height(f);this._splitAreas.sw.css("top",a.splitDistanceY+c);this._splitAreas.se.css("marginTop",a.splitDistanceY)}}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.selection=function(b){var g=0,k,d=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),c=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),e=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),f=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),h=null,j=null,i={singlecell:[0,0,0],singlecolumn:[1,1,1],singlerow:[2,2,2],singlerange:[0,1,2],multicolumn:[1,1,1],multirow:[2,2,2],multirange:[0,1,2]};this.selectedCells=function(){return e};this.addColumns=function(b,a){if(!a&&a!==0)a=b;this.addRange(b,0,a,16777215)};this.addRange=function(c,f,e,g){if(!c&&arguments.length===1)throw"invalid argument";var d=arguments.length===4?new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(c,f),new a.wijmo.wijgrid.cellInfo(e,g)):c._clone();d._normalize();if(!d._isValid())throw"invalid argument";this.beginUpdate();this._startNewTransaction(b._field("currentCell"));this._selectRange(d,false,true,0,null);this.endUpdate()};this.addRows=function(b,a){if(!a&&a!==0)a=b;this.addRange(0,b,16777215,a)};this.removeRange=function(c,f,e,g){if(!c&&arguments.length===1)throw"invalid argument";var d=arguments.length===4?new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(c,f),new a.wijmo.wijgrid.cellInfo(e,g)):c._clone();d._normalize();if(!d._isValid())throw"invalid argument";this.beginUpdate();this._startNewTransaction(b._field("currentCell"));this._clearRange(d,0);this.endUpdate()};this.removeColumns=function(b,a){if(!a&&a!==0)a=b;this.removeRange(b,0,a,16777215)};this.removeRows=function(b,a){if(!a&&a!==0)a=b;this.removeRange(0,b,16777215,a)};this.addRows=function(b,a){if(!a&&a!==0)a=b;this.addRange(0,b,65535,a)};this.clear=function(){this.beginUpdate();c._clear();c._addFrom(e);this.endUpdate()};this.selectAll=function(){this.beginUpdate();this._selectRange(b._getDataCellsRange(),false,false,0,null);this.endUpdate()};this.beginUpdate=function(){g++};this.endUpdate=function(){if(g>0){g--;if(g===0){l();if(d.length()||c.length()){h!==null&&h.UnderlyingDataChanged();j!==null&&j.UnderlyingDataChanged();b._trigger("selectionChanged",null,{addedCells:d,removedCells:c})}d=new a.wijmo.wijgrid.cellInfoOrderedCollection(b);c._clear()}}};this._multipleRangesAllowed=function(){var a=b.options.selectionMode;return a&&((a=a.toLowerCase())==="multicolumn"||a==="multirow"||a==="multirange")};this._anchorCell=function(){return k};this._startNewTransaction=function(c){if(c){k=c._clone();f=new a.wijmo.wijgrid.cellInfoOrderedCollection(b)}};this._clearRange=function(g,l){var h=b.options.selectionMode.toLowerCase(),a,n,m,p,q,o,d,k,f,j=b._getDataCellsRange();if(g._isValid()&&h!=="none"&&e.length()>0){a=g._clone();a._normalize();a._clip(j);if(!g._isValid())return;a._extend(i[h][l],j);this.beginUpdate();for(d=0,k=e.length();d<k;d++){f=e.item(d);a._containsCellInfo(f)&&c._add(f)}this.endUpdate()}};this._selectRange=function(k,n,j,l,g){var e=b.options.selectionMode.toLowerCase(),d,h=b._getDataCellsRange();if(e!=="none"&&k._isValid()){d=k._clone();d._normalize();d._clip(h);if(!d._isValid())return;this.beginUpdate();if(!this._multipleRangesAllowed())this.clear();else if(n||j){if(j){c._clear();c._addFrom(f)}}else this.clear();switch(e){case"singlecell":case"singlecolumn":case"singlerow":d=g===null?new a.wijmo.wijgrid.cellInfoRange(d.topLeft(),d.topLeft()):new a.wijmo.wijgrid.cellInfoRange(g,g)}d._extend(i[e][l],h);m(d,true);this.endUpdate()}};function l(){var s=b._getDataToAbsOffset(),q=s.x,r=s.y,k=b._view(),h,l,g,j,i,p,t=a.wijmo.wijgrid.renderState,n,o,m=-1;for(h=0,l=c.length();h<l;h++){g=c.item(h);if(d.indexOf(g)<0){j=k.getCell(g.cellIndex()+q,g.rowIndex()+r);if(j){if(m!==g.rowIndex()){n=k._getRowInfo(g._row());m=g.rowIndex()}i=a(j);o=k._changeCellRenderState(i,t.selected,false);b.cellStyleFormatter.format(i,g.cellIndex(),g.column(),n,o)}e._remove(g);f._remove(g)}else{c._removeAt(h);h--;l--}}m=-1;for(h=0,l=d.length();h<l;h++){g=d.item(h);p=e.indexOf(g);if(p<0){j=k.getCell(g.cellIndex()+q,g.rowIndex()+r);if(j){if(m!==g.rowIndex()){n=k._getRowInfo(g._row());m=g.rowIndex()}i=a(j);o=k._changeCellRenderState(i,t.selected,true);b.cellStyleFormatter.format(i,g.cellIndex(),g.column(),n,o)}e._insertUnsafe(g,~p);f._add(g)}else{d._removeAt(h);h--;l--}}}function m(h,q){var l=h.topLeft().cellIndex(),n=h.topLeft().rowIndex(),m=h.bottomRight().cellIndex(),o=h.bottomRight().rowIndex(),i,e,f,g,p=b._view(),j,k;if(q){i=d.length();k=b._rows();for(e=n;e<=o;e++){j=p._getRowInfo(k.item(e));if(j.type&a.wijmo.wijgrid.rowType.data)for(f=l;f<=m;f++){g=new a.wijmo.wijgrid.cellInfo(f,e);if(i===0)d._appendUnsafe(g);else d._add(g)}}}else{i=c.length();for(e=n;e<=o;e++)for(f=l;f<=m;f++){g=new a.wijmo.wijgrid.cellInfo(f,e);if(i===0)c._appendUnsafe(g);else c._add(g)}}}};a.wijmo.wijgrid.cellInfoOrderedCollection=function(c){if(!c)throw"argument is null";var b=[];this.item=function(a){return b[a]};this.length=function(){return b.length};this.indexOf=function(e,h){if(arguments.length===1){h=e.rowIndex();e=e.cellIndex()}var d=0,g=b.length-1,c,f,a;while(d<=g){c=d+(g-d>>1);f=b[c];a=f.rowIndex()-h;if(a===0)a=f.cellIndex()-e;if(a<0)d=c+1;else if(a>0)g=c-1;else return c}return~d};this.toString=function(){var d="",a,c;for(a=0,c=b.length;a<c;a++)d+=b[a].toString()+"\n";return d};this._add=function(a){var d=this.indexOf(a);if(d<0){b.splice(~d,0,a);a._setGridView(c);return true}return false};this._addFrom=function(d){if(d){var e=d.length(),f=b.length,a;if(f===0){b.length=e;for(a=0;a<e;a++){b[a]=d.item(a);b[a]._setGridView(c)}}else for(a=0;a<e;a++)this._add(d.item(a))}};this._appendUnsafe=function(a){b[b.length]=a;a._setGridView(c)};this._insertUnsafe=function(c,a){b.splice(a,0,c)};this._clear=function(){b.length=0};this._remove=function(c){var a=this.indexOf(c);if(a>=0){b.splice(a,1);return true}return false};this._removeAt=function(a){b.splice(a,1)};this._getColumnsIndicies=function(){var e=[],d=b.length,c,a,f;if(d){c=[];for(a=0;a<d;a++)c[b[a].cellIndex()]=1;d=c.length;f=0;for(a=0;a<d;a++)if(c[a])e[f++]=a}return e};this._getSelectedRowsIndicies=function(){var f=[],d=b.length,c,a,e;if(d){c=[];for(a=0;a<d;a++)c[b[a].rowIndex()]=1;d=c.length;e=0;for(a=0;a<d;a++)if(c[a])f[e++]=a}return f};this._rectangulate=function(){var i=b.length,e=4294967295,g=4294967295,f=0,h=0,d,c;if(i){for(d=0;d<i;d++){c=b[d];e=Math.min(e,c.cellIndex());g=Math.min(g,c.rowIndex());f=Math.max(f,c.cellIndex());h=Math.max(h,c.rowIndex())}return new a.wijmo.wijgrid.cellInfoRange(new a.wijmo.wijgrid.cellInfo(e,g),new a.wijmo.wijgrid.cellInfo(f,h))}return null}}})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{selectionui:function(b){var q=10,u="{0}."+b.widgetName+".selectionui",d=new a.wijmo.wijgrid.cellInfoOrderedCollection(b),k,f,h,e,i=false,j=false,c=b._view(),t=b._field("visibleLeaves").length,r=c.focusableElement();r.bind(g("mousedown"),p);this.dispose=function(){r.unbind(g("mousedown"),p);l()};function p(e){if(!b._canInteract()||b.options.selectionMode.toLowerCase()==="none")return;var d=c.getVisibleAreaBounds(),g={x:e.pageX,y:e.pageY},i=e.target&&e.target.tagName!==undefined?e.target.tagName.toLowerCase():undefined,h=a(e.target);if((!i||h.is("td.wijgridtd, th.wijgridtd, div.wijmo-wijgrid-innercell"))&&g.x>d.left&&g.x<d.left+d.width&&g.y>d.top&&g.y<d.top+d.height){s();k=g;f=m(k)}}function n(C){if(!f||!f._isValid())return;var y={x:C.pageX,y:C.pageY},z,j,t,s,B,A,w,l,n,v,g,r,p,o,x,u=b._view(),E=b._rows(),D=a.wijmo.wijgrid.renderState;if(!i)i=Math.abs(k.x-y.x)>q||Math.abs(k.y-y.y)>q;if(i){z=m(y);if(!z._isValid())return;h=z;j=new a.wijmo.wijgrid.cellInfoRange(f,h);j._normalize();j._clip(b._getDataCellsRange());if(j._isValid()&&!j.isEqual(e)){t=b._getDataToAbsOffset();e=j;s=new a.wijmo.wijgrid.cellInfoOrderedCollection(b);B=j.bottomRight().rowIndex();A=j.bottomRight().cellIndex();for(w=j.topLeft().rowIndex();w<=B;w++){p=u._getRowInfo(E.item(w));if(p.type&a.wijmo.wijgrid.rowType.data)for(l=j.topLeft().cellIndex();l<=A;l++)s._appendUnsafe(new a.wijmo.wijgrid.cellInfo(l,w))}o=-1;for(n=0,v=d.length();n<v;n++){g=d.item(n);if(s.indexOf(g)<0){if(b.selection().selectedCells().indexOf(g)<0){l=c.getCell(g.cellIndex()+t.x,g.rowIndex()+t.y);if(l){if(o!==g.rowIndex()){p=u._getRowInfo(g._row());o=g.rowIndex()}r=a(l);x=u._changeCellRenderState(r,D.selected,false);b.cellStyleFormatter.format(r,g.cellIndex(),g.column(),p,x)}}d._removeAt(n);n--;v--}}o=-1;for(n=0,v=s.length();n<v;n++){g=s.item(n);if(d.indexOf(g)<0&&b.selection().selectedCells().indexOf(g)<0)if(d._add(g)){l=c.getCell(g.cellIndex()+t.x,g.rowIndex()+t.y);if(l){if(o!==g.rowIndex()){p=u._getRowInfo(g._row());o=g.rowIndex()}r=a(l);x=u._changeCellRenderState(r,D.selected,true);b.cellStyleFormatter.format(r,g.cellIndex(),g.column(),p,x)}}}}}}function o(k){l();if(i){i=false;if(e&&e._isValid()){b._changeCurrentCell(h);(!k.shiftKey||!b.selection()._multipleRangesAllowed()&&b.options.selectionMode.toLowerCase()!=="singleRange")&&b.selection()._startNewTransaction(f);b.selection().beginUpdate();b.selection()._selectRange(e,k.shiftKey,k.ctrlKey,0,h);b.selection().endUpdate();var n=b._view(),p=b._getDataToAbsOffset(),g,s,c,m,j,o=-1,q,r,t=a.wijmo.wijgrid.renderState;for(g=0,s=d.length();g<s;g++){c=d.item(g);if(b.selection().selectedCells().indexOf(c)<0){m=n.getCell(c.cellIndex()+p.x,c.rowIndex()+p.y);if(m!==null){if(o!==c.rowIndex()){q=n._getRowInfo(c._row());o=c.rowIndex()}j=a(m);r=n._changeCellRenderState(j,t.selected,false);b.cellStyleFormatter.format(j,c.cellIndex(),c.column(),q,r)}}}d._clear();f=h=e=null;return false}}}function s(){if(!j)try{c.toggleDOMSelection(false);a(document).bind(g("mousemove"),n).bind(g("mouseup"),o)}finally{j=true}}function l(){if(j)try{c.toggleDOMSelection(true);a(document).unbind(g("mousemove"),n).unbind(g("mouseup"),o)}finally{j=false}}function g(b){return a.wijmo.wijgrid.stringFormat(u,b)}function m(k){var f=0,g=t-1,d=0,m=-1,e,h=new a.wijmo.wijgrid.rowAccessor(c,2,0,0),i,j,l,n;while(f<=g){d=(g-f>>1)+f;e=a.wijmo.wijgrid.bounds(c.getHeaderCell(d));if(!e){j=h.item(0);e=a.wijmo.wijgrid.bounds(h.getCell(j,d))}if(!e)break;if(k.x<e.left)g=d-1;else if(k.x>e.left+e.width)f=d+1;else{m=d;break}}if(m===-1)return a.wijmo.wijgrid.cellInfo.prototype.outsideValue;h=new a.wijmo.wijgrid.rowAccessor(c,0,0,0);i=-1;f=0;g=h.length()-1;d=0;while(f<=g){d=(g-f>>1)+f;j=h.item(d);e=a.wijmo.wijgrid.bounds(h.getCell(j,0));if(k.y<e.top)g=d-1;else if(k.y>e.top+e.height)f=d+1;else{i=d;break}}if(i===-1)return a.wijmo.wijgrid.cellInfo.prototype.outsideValue;l=b._getDataToAbsOffset();n=new a.wijmo.wijgrid.cellInfo(m-l.x,i-l.y);n._clip(b._getDataCellsRange());return n}}})})(jQuery);(function(a){"use strict";a.wijmo.wijgrid.rowAccessor=function(d,c,f,e){var a=f,b=e;if(!a)a=0;if(!b)b=0;this.item=function(b){var e=this.length();return b<e?d.getJoinedRows(b+a,c):null};this.length=function(){var g=d.getJoinedTables(true,0),e=0,f;if(f=g[0])e=f.getSectionLength(c);if(f=g[1])e+=f.getSectionLength(c);e-=a+b;if(e<0)e=0;return e};this.iterateCells=function(d,e,j){if(d&&e){var i=0,b,h,a,c,f,g;for(b=0,h=d.length;b<h;b++){a=d[b];if(a)for(c=0,f=a.cells.length;c<f;c++){g=e(a.cells[c],i++,j);if(g!==true)return}}}};this.getCell=function(d,b){var a,c;if(d&&(a=d[0])){c=a.cells.length;if(b<c)return a.cells[b];b-=c;if(a=d[1]){c=a.cells.length;if(b<c)return a.cells[b]}}return null};this.cellsCount=function(b){var c=0,a;if(b&&(a=b[0])){c=a.cells.length;if(a=b[1])c+=a.cells.length}return c};this._offsetBottom=function(a){if(arguments.length)b=a;return b};this._offsetTop=function(b){if(arguments.length)a=b;return a}}})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{cellEditorHelper:function(){this.currentCellEditStart=function(e,k){var g=false,b=e.currentCell(),j=e._view(),d,h,f,i;if(b._isValid()&&!b._isEdit()&&b.column().dataIndex>=0){d=b._row();if(d&&d.length){i=j._getRowInfo(d).type;if(i&a.wijmo.wijgrid.rowType.data){h={cell:b,event:k,handled:false};if(g=e._trigger("beforeCellEdit",null,h))if(!h.handled)g=c(e,h);if(g){b._isEdit(true);if(e.options.showRowHeader){f=a(d[0].cells[0]).children("div.wijmo-wijgrid-innercell");if(f.length){f.empty();f.append(a("<div>&nbsp;</div>").addClass("ui-icon ui-icon-pencil"))}}}}}}return g};this.currentCellEditEnd=function(f,k){var c=f.currentCell(),g=false,n=f._view(),i,m,l,b,h,j;if(!c._isValid()||!c._isEdit())return;i=c._row();if(i&&i.length){m=n._getRowInfo(i).type;if(!(m&a.wijmo.wijgrid.rowType.data))return g;l=k&&k.which===a.ui.keyCode.ESCAPE;if(!k||!l){b={cell:c,value:undefined};if(g=f._trigger("beforeCellUpdate",null,b)){if(b.value===undefined)b.value=e(f,c);h=b.value;try{b.value=f._parse(c.column(),b.value);h=b.value}catch(o){b.value=h}j=c.value();if(b.cell.column().dataType==="datetime"){if(h instanceof Date)h=h.getTime();if(j instanceof Date)j=j.getTime()}if(h!==j){try{c.value(b.value)}catch(o){g=false;f._trigger("invalidCellValue",null,{cell:c,value:b.value})}g&&f._trigger("afterCellUpdate",null,{cell:c})}}}else g=true;if(g){b={cell:c,event:k,handled:false};f._trigger("afterCellEdit",null,b);if(!b.handled)g=d(f,b);g&&c._isEdit(false);f.options.showRowHeader&&a(i[0].cells[0]).children("div.wijmo-wijgrid-innercell").html("&nbsp;");window.setTimeout(function(){if(!f.destroyed){f.element.focus();a(f._view().focusableElement()).focus();c.tableCell().focus()}},50)}}return g};function c(k,d){var j=d.cell.column(),h=false,f,g,c,i,e;if(j.dataIndex>=0){f=d.cell.value();h=true;try{g=d.cell.container();if(j.dataType==="boolean"){c=g.children("input");c.focus();if(d.event&&d.event.type==="keypress")c.one("keyup",function(b){if(b.which===a.ui.keyCode.SPACE){b.preventDefault();c[0].checked=!f}})}else{c=a("<input />").attr("type","text").addClass("wijgridinput wijmo-wijinput ui-state-focus").bind("keydown",k,b);c.bind(a.support.selectstart?"selectstart":"mousedown",function(a){a.stopPropagation()});if(d.event&&d.event.type==="keypress"&&d.event.which)c.val(String.fromCharCode(d.event.which));else switch(d.cell.column().dataType){case"currency":case"number":if(f!==null){c.val(f);break}default:c.val(k._toStr(d.cell.column(),f))}g.empty().append(c);i=c.val().length;new a.wijmo.wijgrid.domSelection(c[0]).setSelection({start:i,end:i});c.focus();a.browser.msie&&setTimeout(function(){c.focus()},0);if(a.browser.mozilla&&document.createEvent&&c[0].dispatchEvent){e=document.createEvent("KeyboardEvent");e.initKeyEvent("keypress",false,true,null,false,false,false,false,0,a.ui.keyCode.SPACE);c[0].dispatchEvent(e);e=document.createEvent("KeyboardEvent");e.initKeyEvent("keypress",false,true,null,false,false,false,false,a.ui.keyCode.BACKSPACE,0);c[0].dispatchEvent(e)}}}catch(l){alert(l.message);h=false}}return h}function d(a,c){var b=c.cell.column(),g=false,d,e,i,h,f,j;if(b.dataIndex>=0){g=true;j=a._view();try{d=c.cell.container();e=a._toStr(b,c.cell.value());f=j._getRowInfo(a._rows().item(c.cell.rowIndex()));i=a._getDataItem(f.dataItemIndex);if(b.dataType==="boolean"){h=d.children("input");if(e==="true")h.attr("checked","checked");else h.removeAttr("checked")}else a.cellFormatter.format(d,b,e,f.type,i)}catch(k){alert("defaultAfterCellEdit: "+k.message);g=false}}return g}function b(b){if(b.which===a.ui.keyCode.ENTER){var c=b.data;if(c){c._endEditInternal(b);return false}}}function e(d,c){var a=c.container().find(":input:first"),b=null;if(a.length)b=a.attr("type")==="checkbox"?a[0].checked:a.val();return b}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{resizer:function(h){var i=[],t=10,s=1,v="{0}."+h.widgetName+".resizer",e=false,b=null,r,f=null,d=null,g=null;this.addElement=function(a){if(a&&a.element){a.element.bind(c("mousemove"),q).bind(c("mousedown"),p).bind(c("mouseout"),j);i.push(a)}};this.dispose=function(){a.each(i,function(b,a){a.element.unbind(c("mousemove"),q).unbind(c("mousedown"),p).unbind(c("mouseout"),j)});m()};this.inProgress=function(){return e};function q(c){if(!e){var a=o({x:c.pageX,y:c.pageY});if(a&&a._canSize()&&h._canInteract()){a.element.css("cursor","e-resize");b=a;c.stopPropagation()}else j(c)}}function j(){if(!e)if(b){b.element.css("cursor","");b=null}}function p(c){b=o({x:c.pageX,y:c.pageY});if(b&&b._canSize()&&h._canInteract())try{b.element.css("cursor","");r=document.body.style.cursor;document.body.style.cursor="e-resize";f=d=a.wijmo.wijgrid.bounds(b.element);g=a('<div class="wijmo-wijgrid-resizehandle ui-state-highlight">&nbsp;</div>');var i=h._view().getVisibleAreaBounds();g.css({left:c.pageX,top:f.top,height:i.height+i.top-f.top});a(document.body).append(g)}finally{u();e=true;c.stopPropagation()}}function k(a){var b=s*Math.round((a.pageX-d.left)/s);d={left:d.left+b,top:a.pageY};g.css("left",d.left)}function l(){try{document.body.style.cursor=r;g.remove();f!==d&&h._fieldResized(b,f.width,d.left-f.left)}finally{b=null;g=null;m();e=false}}function n(a){a.preventDefault()}function u(){if(!e){a(document).bind(c("mousemove"),k).bind(c("mouseup"),l);a(document.body).disableSelection();a.browser.msie&&a(document.body).bind("selectstart",n)}}function m(){if(e){a(document).unbind(c("mousemove"),k).unbind(c("mouseup"),l);a(document.body).enableSelection();a.browser.msie&&a(document.body).unbind("selectstart",n)}}function o(e){var c,f,d,b,g;for(c=0,f=i.length;c<f;c++){d=i[c];b=a.wijmo.wijgrid.bounds(d.element);g=a.ui.isOver(e.y,e.x,b.top,b.left+b.width-t,b.height,t);if(g)return d}return null}function c(b){return a.wijmo.wijgrid.stringFormat(v,b)}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{frozener:function(b){var s,r,z,y,F="{0}."+b.widgetName+".frozener",d=false,x,f=null,e=null,h=null,g=null,n=a('<div class="wijmo-wijgrid-frozener-v ui-widget-header"></div>'),m=a('<div class="wijmo-wijgrid-frozener-h ui-widget-header"></div>'),k=null,j=null,c=b.outerDiv.find(".wijmo-wijgrid-fixedview"),l=10;this.refresh=function(){this.dispose();this.addVElement(b._getStaticIndex(false));this.addHElement(b._getStaticIndex(true));this.attachDivEvent()};this.attachDivEvent=function(){c.bind("mousemove",u).bind("mouseout",q).bind("mousedown",t)};this.addVElement=function(h){var e=a.wijmo.wijgrid.bounds(c.find(".wijmo-wijgrid-split-area-nw")),f=a.wijmo.wijgrid.bounds(c),d=b._view().getVisibleAreaBounds(),g=e.left+e.width;if(g<=d.left+d.width){n.css({left:g-f.left-1,top:e.top-f.top,width:"0px",height:d.height+d.top-e.top}).appendTo(c);s=b._getRealStaticColumnIndex(true);z=h}};this.addHElement=function(h){var e=a.wijmo.wijgrid.bounds(c.find(".wijmo-wijgrid-split-area-nw")),f=a.wijmo.wijgrid.bounds(c),d=b._view().getVisibleAreaBounds(),g=e.top+e.height;if(g<=d.top+d.height){m.css({left:e.left-f.left,top:g-f.top-1,width:d.width+d.left-e.left,height:"0px"}).appendTo(c);r=b._getRealStaticRowIndex(true);y=h}};this.dispose=function(){n.remove();m.remove();c.unbind("mousemove",u).unbind("mouseout",q).unbind("mousedown",t);v()};this.inProgress=function(){return d};function u(f){var e,h,g=b._view().getVisibleAreaBounds();if(!d)if(b._canInteract()&&a.ui.isOver(f.pageY,f.pageX,g.top,g.left,g.height,g.width)){e=a.wijmo.wijgrid.bounds(n);h=e.left+e.width/2;if(Math.abs(f.pageX-h)<l){c.css("cursor","pointer");return}e=a.wijmo.wijgrid.bounds(m);h=e.top+e.height/2;if(Math.abs(f.pageY-h)<l){c.css("cursor","pointer");return}q(f)}}function q(){!d&&c.css("cursor","")}function t(i){var o,q,t,p=b._view().getVisibleAreaBounds();if(b._canInteract()&&a.ui.isOver(i.pageY,i.pageX,p.top,p.left,p.height,p.width)){o=a.wijmo.wijgrid.bounds(n);q=o.left+o.width/2;if(Math.abs(i.pageX-q)<l){if(z===-1)f=h=-1;else f=h=b._getRealStaticColumnIndex()-s;k=a('<div class="wijmo-wijgrid-resizehandle ui-widget-header"></div>');i.data={bVertical:true};a(document.body).append(k)}else{o=a.wijmo.wijgrid.bounds(m);q=o.top+o.height/2;if(Math.abs(i.pageY-q)<l){if(y===-1)e=g=-1;else e=g=b._getRealStaticRowIndex()-r;j=a('<div class="wijmo-wijgrid-resizehandle ui-widget-header"></div>');i.data={bVertical:false};a(document.body).append(j)}}if(i.data){c.css("cursor","");x=document.body.style.cursor;document.body.style.cursor="pointer";B(i.data);d=true}}}function o(c){var a=b._view()._getSuperPanel();if(c.data.bVertical&&a.options.hScroller.scrollValue)a.hScrollTo(0);else!c.data.bVertical&&a.options.vScroller.scrollValue&&a.vScrollTo(0);G(c)}function p(a){try{document.body.style.cursor=x;if(a.data.bVertical){k.remove();f!==h&&b.option("staticColumnIndex",h)}else{j.remove();e!==g&&b.option("staticRowIndex",g)}}finally{if(a.data.bVertical)k=null;else j=null;v();d=false}}function w(a){a.preventDefault()}function B(b){if(!d){if(b.bVertical)a(document).bind(i("mousemove"),{bVertical:true},o).bind(i("mouseup"),{bVertical:true},p);else a(document).bind(i("mousemove"),{bVertical:false},o).bind(i("mouseup"),{bVertical:false},p);a(document.body).disableSelection();a.browser.msie&&a(document.body).bind("selectstart",w)}}function v(){if(d){a(document).unbind(i("mousemove"),o).unbind(i("mouseup"),p);a(document.body).enableSelection();a.browser.msie&&a(document.body).unbind("selectstart",w)}}function G(d){var i,c,p,t,q,u,v,w,o=b._view().getVisibleAreaBounds();if(d.data.bVertical){c=a.wijmo.wijgrid.bounds(n);p=c.left+c.width/2;if(Math.abs(d.pageX-p)<l){h=f;k.hide();return}i=D({x:d.pageX,y:d.pageY});if(i){c=a.wijmo.wijgrid.bounds(i.element);p=c.left+c.width/2;q=i.options.visLeavesIdx-s;u=A(q);t=d.pageX<p?u!==f:q===f;v=t?c.left:c.left+c.width;if(!a.ui.isOverAxis(v,o.left-1,o.width+2))return;h=t?u:q;k.show().css({left:v,top:c.top,width:3,height:o.height+o.top-c.top})}}else{c=a.wijmo.wijgrid.bounds(m);p=c.top+c.height/2;if(Math.abs(d.pageY-p)<l){g=e;j.hide();return}i=E({x:d.pageX,y:d.pageY});if(i){c=a.wijmo.wijgrid.bounds(i);p=c.top+c.height/2;q=b._view().getAbsoluteRowIndex(i)-r;u=C(q);t=d.pageY<p?u!==e:q===e;w=t?c.top:c.top+c.height;if(!a.ui.isOverAxis(w,o.top-1,o.height+2))return;g=t?u:q;j.show().css({left:c.left,top:w,width:o.width+o.left-c.left,height:3})}}}function A(a){return a>-1?a-1:-1}function C(a){return a>-1?a-1:-1}function D(i){for(var g=b.columns(),f=0,j=g.length,c,d,e,h;f<j;f++){c=g[f];d=c.options;if(d.visible&&d.parentVis&&d.isLeaf){e=a.wijmo.wijgrid.bounds(c.element);h=a.ui.isOverAxis(i.x,e.left,e.width);if(h)return c}}return null}function E(i){for(var f=b._rows(),h=f.length(),d=0,e,c,g;d<h;d++){e=f.item(d)[0];c=a.wijmo.wijgrid.bounds(a(e));g=a.ui.isOverAxis(i.y,c.top,c.height);if(g)return e}return null}function i(b){return a.wijmo.wijgrid.stringFormat(F,b)}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{cellFormatterHelper:function(){this.format=function(j,c,g,i){if(i.type&a.wijmo.wijgrid.rowType.footer)if(c.aggregate&&c.aggregate!=="none")g=a.wijmo.wijgrid.stringFormat(c.footerText||"{0}",c._totalsValue||"");else g=c.footerText||c._footerTextDOM||"";var h=true,f=null,e={$container:j,column:c,formattedValue:g,row:i,afterDefaultCallback:null};if(a.isFunction(c.cellFormatter))h=!c.cellFormatter(e);if(h){switch(c.dataType){case"boolean":f=d;break;default:f=b}if(f){f(e);a.isFunction(e.afterDefaultCallback)&&e.afterDefaultCallback(e)}}};function b(b){switch(b.row.type){case a.wijmo.wijgrid.rowType.filter:c(b);break;default:b.$container.html(b.formattedValue?b.formattedValue:"&nbsp;")}}function d(c){var d,f,h="disabled='disabled'",e,g,i=a.wijmo.wijgrid.rowType;switch(c.row.type){case i.data:case i.data|i.dataAlt:d=c.column.owner;f=d.options.allowEditing&&c.column.readOnly!==true;if(f)h="";if(d._parse(c.column,c.row.data[c.column.dataKey])===true)c.$container.html("<input class='wijgridinput' type='checkbox' checked='checked' "+h+" />");else c.$container.html("<input class='wijgridinput' type='checkbox' "+h+" />");f&&c.$container.children("input").bind("mousedown",function(){e=c.$container.parent()[0];g=d.currentCell();g.tableCell()!==e&&d._onClick({target:e});!g._isEdit()&&d.beginEdit()}).bind("keydown",function(b){if(b.which===a.ui.keyCode.ENTER){d._endEditInternal(b);return false}});break;default:b(c)}}function c(a){a.$container.addClass("ui-widget ui-state-default");if(a.column.dataIndex>=0&&!a.column.isBand&&a.column.showFilter)a.$container.html('<div class="wijmo-wijgrid-filter ui-corner-all"><input type="text" class="wijmo-wijgrid-filter-input" style="width:1px" /><a class="wijmo-wijgrid-filter-trigger ui-corner-right ui-state-default" href="#"><span class="ui-icon ui-icon-triangle-1-s"></span></a></div>');else a.$container.html("&nbsp;")}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{dragAndDropHelper:function(c){var i="scope_"+ +new Date,d=null,e=null,b=null,g=false,h,p='<div class="ui-widget wijmo-wijgrid ui-widget-content ui-corner-all"><table class="wijmo-wijgrid-root wijmo-wijgrid-table"><tr class="wijmo-wijgrid-headerrow"></tr></table></div>';this.attachGroupArea=function(e){var d;e.droppable({scope:i,tolerance:"pointer",greedy:true,accept:function(b){if(c.options.allowColMoving){d=f(b);if(d)return d instanceof a.wijmo.c1groupedfield&&d.options.groupedIndex===c._field("groupedColumns").length-1?false:!d.options.isBand&&(d.options.groupedIndex===undefined||d instanceof a.wijmo.c1groupedfield)}return false},drop:function(b,a){if(!l(b,a.draggable)&&(d=f(a.draggable)))g=true},over:function(){var a=c._field("groupedWidgets").length;h=a>0;b=a>0?c._field("groupedWidgets")[a-1]:e;e.data("thisDroppableWijField",b)},out:function(){if(b===e.data("thisDroppableWijField"))b=null}})};this.attach=function(d){var e,j;if(!d||!(e=d.element))return;e.draggable({helper:function(){return d instanceof a.wijmo.c1groupedfield?e.clone().addClass("wijmo-wijgrid-dnd-helper"):e.clone().wrap(p).width(e.width()).height(e.height()).closest(".wijmo-wijgrid").addClass("wijmo-wijgrid-dnd-helper")},appendTo:"body",scope:i,drag:function(c,f){m();if(b&&!l(c,e)){var a=b.element;if(!a)a=b;o(a,k(d,b,c,f))}},start:function(){if(c._canInteract()&&c.options.allowColMoving&&!c._field("resizer").inProgress()){var b=d.options,g=d.options.travIdx,e=d instanceof a.wijmo.c1groupedfield,f=e?"groupArea":"columns";if(e){b=a.wijmo.wijgrid.search(c.columns(),function(a){return a.options.travIdx===g});b=!b.found?a.wijmo.wijgrid.getColumnByTravIdx(c.options.columns,g).found:b.found.options}if(d._canDrag()&&c._trigger("columnDragging",null,{drag:b,dragSource:f})){c._trigger("columnDragged",null,{drag:b,dragSource:f});return true}}return false},stop:function(f,e){m();try{if(g)if(!b.element)c._handleDragnDrop(d.options.travIdx,-1,"left",d instanceof a.wijmo.c1groupedfield,true);else c._handleDragnDrop(d.options.travIdx,b.options.travIdx,k(d,b,f,e),d instanceof a.wijmo.c1groupedfield,b instanceof a.wijmo.c1groupedfield)}finally{b=null;g=false}}}).droppable({hoverClass:"ui-state-hover",scope:i,tolerance:"pointer",greedy:true,accept:function(a){if(c.options.allowColMoving)if(e[0]!==a[0]){j=f(a);if(j)return j._canDropTo(d)}return false},drop:function(b,a){if(j=f(a.draggable))g=true},over:function(){h=false;b=d;e.data("thisDroppableWijField",b)},out:function(){if(b===d.element.data("thisDroppableWijField"))b=null}})};this.detach=function(b){var a;if(b&&(a=b.element)){a.data("draggable")&&a.draggable("destroy");a.data("droppable")&&a.droppable("destroy")}};this.dispose=function(){if(e){e.remove();e=null}if(d){d.remove();d=null}};function f(b){var c=b.data(a.wijmo.c1basefield.prototype._data$prefix+"widgetName");return!c?b.data(a.wijmo.c1groupedfield.prototype._data$prefix):b.data(c)}function o(a,b){n().show().position({my:"center",at:b+" top",of:a});j().show().position({my:"center",at:b+" bottom",of:a})}function m(){n().hide();j().hide()}function n(){if(!e)e=a("<div />").addClass("wijmo-wijgrid-dnd-arrow-top").append(a("<span />").addClass("ui-icon ui-icon-arrowthick-1-s")).hide().appendTo(document.body);return e}function j(){if(!d)d=a("<div />").addClass("wijmo-wijgrid-dnd-arrow-bottom").append(a("<span />").addClass("ui-icon ui-icon-arrowthick-1-n")).hide().appendTo(document.body);return d}function l(c,d){var b=a.wijmo.wijgrid.bounds(d,false);return c.pageX>b.left&&c.pageX<b.left+b.width&&c.pageY>b.top&&c.pageY<b.top+b.height}function k(e,b,i){if(!b.element)return"left";if(h)return"right";var f=a.wijmo.wijgrid.bounds(b.element,false),j=f.width/6,g=f.left+f.width/2,d="right",c;if(i.pageX<g)d="left";if(b instanceof a.wijmo.c1groupedfield){if(e instanceof a.wijmo.c1groupedfield){c=b.options.groupedIndex-e.options.groupedIndex;if(Math.abs(c)===1)d=c<0?"left":"right"}return d}c=b.options.linearIdx-e.options.linearIdx;if(b.options.isBand&&e.options.parentIdx!==b.options.travIdx&&Math.abs(i.pageX-g)<j)return"center";if(e.options.parentIdx===b.options.parentIdx&&Math.abs(c)===1)d=c<0?"left":"right";return d}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{cellStyleFormatterHelper:function(b){if(!b)throw"invalid arguments";this.format=function(q,l,i,m,j,h,p){var k=a.wijmo.wijgrid.renderState,o=a.wijmo.wijgrid.rowType,n=m.type,f,g=null;if(l===0&&b.options.showRowHeader)i=null;if(n===o.groupHeader||n===o.groupFooter){i=null;if(h&&(g=h.groupInfo)){i=b._field("leaves")[g.leafIndex];delete h.groupInfo}}f={$cell:q,state:j,row:m,column:i,_cellIndex:l,_purpose:g?g.purpose:undefined};if(j===k.rendering)c(f,h,p);else{e(f,j&k.current);d(f,j&k.selected)}a.isFunction(b.options.cellStyleFormatter)&&b.options.cellStyleFormatter(f)};function c(c,i,g){var f=a.wijmo.wijgrid.rowType,d,j,e=c.column,h=c.row.type;switch(h){case f.header:c.$cell.addClass("wijgridth");break;default:c.$cell.addClass("wijgridtd")}if(i)for(d in i)if(i.hasOwnProperty(d)){j=i[d];if((d==="colSpan"||d==="rowSpan")&&!(j>1))continue;if(d==="class")c.$cell.addClass(j);else c.$cell.attr(d,j)}if(g)for(d in g)if(g.hasOwnProperty(d)){if(d==="paddingLeft"){c.$cell.children(".wijmo-wijgrid-innercell").css(d,g[d]);continue}c.$cell.css(d,g[d])}if(c._cellIndex===0&&b.options.showRowHeader)c.$cell.attr({role:"rowheader",scope:"row"}).addClass("ui-state-default ui-widget-content wijmo-wijgrid-rowheader");else switch(h){case f.header:c.$cell.attr({role:"columnheader",scope:"col"});break;case f.footer:c.$cell.attr({role:"columnfooter",scope:"col"});break;default:c.$cell.attr("role","gridcell")}if(h&f.data)if(c._cellIndex>=0&&e&&e.dataParser){c.$cell.attr("headers",escape(e.headerText));e.readOnly&&c.$cell.attr("aria-readonly",true);e.dataIndex>=0&&c.$cell.addClass("wijdata-type-"+(e.dataType||"string"))}if(h===f.groupHeader||h===f.groupFooter)e&&c._purpose===a.wijmo.wijgrid.groupRowCellPurpose.aggregateCell&&c.$cell.addClass("wijdata-type-"+(e.dataType||"string"))}function e(b,d){var c=a.wijmo.wijgrid.rowType;if(d){b.$cell.addClass("ui-state-active");if(b.row.type===c.header)b.$cell.addClass("wijmo-wijgrid-current-headercell");else b.$cell.addClass("wijmo-wijgrid-current-cell")}else{b.$cell.removeClass("ui-state-active");if(b.row.type===c.header)b.$cell.removeClass("wijmo-wijgrid-current-headercell");else b.$cell.removeClass("wijmo-wijgrid-current-cell")}}function d(a,b){if(b)a.$cell.addClass("ui-state-highlight").attr("aria-selected","true");else a.$cell.removeClass("ui-state-highlight").removeAttr("aria-selected")}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{rowStyleFormatterHelper:function(b){if(!b)throw"invalid arguments";this.format=function(j,l,k){var i=a.wijmo.wijgrid.renderState,h=j.state,g=j;if(h===i.rendering)c(g,l,k);else{e(g,h&i.current);f(g,h&i.hovered);d(g,h&i.selected)}a.isFunction(b.options.rowStyleFormatter)&&b.options.rowStyleFormatter(g)};function c(e,f,h){var c="wijmo-wijgrid-row ui-widget-content",g="wijmo-wijgrid-row ui-widget-content",d=a.wijmo.wijgrid.rowType,b;e.$rows.attr("role","row");if(f)for(b in f)if(f.hasOwnProperty(b))if(b==="class")e.$rows.addClass(f[b]);else e.$rows.attr(b,f[b]);if(h)for(b in h)h.hasOwnProperty(b)&&e.$rows.css(b,h[b]);switch(e.type&~d.dataAlt){case d.header:c="wijmo-wijgrid-headerrow";break;case d.data:c=g+" wijmo-wijgrid-datarow";if(e.type&d.dataAlt)c+=" wijmo-wijgrid-alternatingrow";break;case d.emptyDataRow:c=g+" wijmo-wijgrid-emptydatarow";break;case d.filter:c="wijmo-wijgrid-filterrow";break;case d.groupHeader:c=g+" wijmo-wijgrid-groupheaderrow";break;case d.groupFooter:c=g+" wijmo-wijgrid-groupfooterrow";break;case d.footer:c="wijmo-wijgrid-footerrow ui-state-highlight";break;default:throw a.wijmo.wijgrid.stringFormat("unknown rowType: {0}",e.row.type);}e.$rows.addClass(c)}function e(c,d){if(b.options.showRowHeader)if(d)a(c.$rows[0].cells[0]).addClass("ui-state-active wijmo-wijgrid-current-rowheadercell");else a(c.$rows[0].cells[0]).removeClass("ui-state-active wijmo-wijgrid-current-rowheadercell")}function f(a,b){if(b)a.$rows.addClass("ui-state-hover");else a.$rows.removeClass("ui-state-hover")}function d(b,a){a}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{tally:function(){var h=0,i=0,a=0,b=0,f=0,g=0,d,c;this.add=function(e){if(e===null||e==="")return;b++;if(typeof e==="string"){if(d===undefined||e<d)d=e;if(c===undefined||e>c)c=e}if(typeof e==="number"){if(a===0){g=e;f=e}a++;h+=e;i+=e*e;if(e<g)g=e;if(e>f)f=e}};this.getValueString=function(f){if(a){var h=e(f.aggregate),g=f.owner;return g._toStr(f,h)}if(b)switch(f.aggregate){case"max":return c;case"min":return d;case"count":return b.toString()}return""};function e(d){switch(d){case"average":return a===0?0:h/a;case"count":return b;case"max":return f;case"min":return g;case"sum":return h;case"std":return a<=1?0:Math.sqrt(e("var"));case"stdPop":return a<=1?0:Math.sqrt(e("varPop"));case"var":return a<=1?0:e("varPop")*a/(a-1);case"vapPop":if(a<=1)return 0;var c=h/a;return i/a-c*c}return 0}}})})(jQuery);(function(a){"use strict";a.extend(a.wijmo.wijgrid,{columnsGenerator:function(){this.generate=function(f,b,e){switch(f){case"append":c(b,e);break;case"merge":d(b,e);break;default:throw a.wijmo.wijgrid.stringFormat('Unsupported value: "{0}"',f);}};function c(f,g){var c=f.getFieldNames(),a,e,d;for(a=0,e=c.length;a<e;a++){d=b(c[a]);g.push(d)}}function d(l,i){var g=[],h=l.getFieldNames(),d={},e,k,c,j,f;for(e=0,k=h.length;e<k;e++)d[j=h[e]]=j;a.wijmo.wijgrid.traverse(i,function(b){if(b.isLeaf&&!b.isBand){c=b.dataKey;if(a.wijmo.wijgrid.validDataKey(c)){if(d[c]!==undefined)delete d[c]}else c!==null&&g.push(b)}});if(g.length){e=0;for(c in d)if(d.hasOwnProperty(c)){f=g[e++];if(f){f.dataKey=d[c];delete d[c]}}}for(c in d)if(d.hasOwnProperty(c)){f=b(d[c]);i.push(f)}}function b(b){return a.wijmo.wijgrid.createDynamicField({dataKey:b})}}})})(jQuery);